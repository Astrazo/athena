import{g as i,a as y,b as u,l as g}from"./main-CaYjMSie.js";const l=document.getElementById("noRooms"),d=document.getElementById("roomContent"),m=document.getElementById("roomsGrid");function I(a){m.innerHTML="",a.length===0?(l.style.display="block",d.style.display="none"):(l.style.display="none",d.style.display="block",a.forEach(o=>{const t=(o.roomPlayers?Object.values(o.roomPlayers):[]).length,r=t<4,e=document.createElement("div");e.className="room-card",e.innerHTML=`
                        <div class="room-name">
                            <h3>${o.roomName}</h3>
                        </div>
                        <div class="room-info">
                            Players: ${t}/4
                        </div>
                        ${r?`<button class="std-button join-button" data-room-id="${o.roomId}" data-room-name="${o.roomName}">Join Room</button>`:'<button class="std-button" disabled>Room Full</button>'}
                    `,m.appendChild(e)}),document.querySelectorAll(".join-button").forEach(o=>{o.addEventListener("click",async()=>{const n=document.getElementById("username").value.trim();if(!n){alert("Please enter a room nickname before joining a room!");return}const t=o.dataset.roomId,r=o.dataset.roomName;try{document.getElementById("loadingContainer").style.display="flex";const e=await y(n,r,t);await u(e,n,t,0),localStorage.setItem("connectedRoomId",t),localStorage.setItem("connectedUserId",e),localStorage.setItem("connectedRoomName",r),localStorage.setItem("connectedUsername",n),localStorage.setItem("isHost","0"),localStorage.setItem("readyStatus","0");try{const s=await g(void 0,t,void 0);localStorage.setItem("localRoomData",JSON.stringify(s)),window.location.href="room-lobby.html"}catch(s){console.error("Error loading room:",s),window.location.href="index.html"}}catch(e){console.error("Join failed:",e),alert("Couldn't join the room. Please try again.")}})}))}const c=i(a=>{I(a)});window.addEventListener("beforeunload",()=>{c&&c()});
