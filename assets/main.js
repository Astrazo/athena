(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function o(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=o(i);fetch(i.href,a)}})();const ze={1:{ca:{"server-room":{"Investigate Server Traffic Logs":["Scanning through the IDS logs, you notice suspicious traffic indicative of automated reconnaissance and rapid-fire attacks.","Given this traffic, which IP address most likely belongs to the Rougue AI and must be urgently reviewed?"],"Check Firewall Configuration":["This won't help right now."],"Review Active Directory Logs":["This won't help right now."],"Analyse Authentication Logs":["This won't help right now."],CORRECT_ACTION:"Investigate Server Traffic Logs"},"command-centre":{"Trace Endpoint Behavior by Class":["This won't help right now."],"Update Threat Intelligence Feeds":["This won't help right now."],"Cross-check Audit Trail Against Global Events":["This won't help right now."],"Patch Exposed Service":["This won't help right now."],CORRECT_ACTION:null},"developer-hub":{"Review Access Control File":["This won't help right now."],"Check Developer Login Tokens":["This won't help right now."],"Trigger Endpoint Containment Protocol":["This won't help right now."],"Analyze Recent API Security Logs":["This won't help right now."],CORRECT_ACTION:null},"research-lab":{"Review Email Gateway Rules":["This won't help right now."],"Look Up User Activity History":["You quickly pull up the latest user connection data.","As an expert in cyber security, you're used to analysing things like login times, locations, and device patterns to determine if an account has been hijacked.","If anything looks off here, you should flag it immediately before the AI burrows deeper."],"Reboot Threat Detection System":["This won't help right now."],"Run Network Speed Diagnostics":["This won't help right now."],CORRECT_ACTION:"Look Up User Activity History"}},ne:{"server-room":{"Audit Monitoring Scripts":["This won't help right now."],"Reconfigure VLAN Assignments":["This won't help right now."],"Check UPS and Cooling Network Interfaces":["This won't help right now."],"Patch Firewall Configuration":["This won't help right now."],CORRECT_ACTION:null},"command-centre":{"Review Network Topology Diagrams":["This won't help right now."],"Analyse Firewall Logs":["This won't help right now."],"Examine Firewall Rule Propagation":["This won't help right now."],"Compare Interface Access Logs":["You cross-reference interface logs from the Command Centre for irregular access times, frequency spikes, or unauthorized devices.","One of them doesn’t match the baseline. Which one is it?"],CORRECT_ACTION:"Compare Interface Access Logs"},"developer-hub":{"Audit Static IP Assignments":["This won't help right now."],"Check Network Mapping for Dev Machines":["This won't help right now."],"Monitor DHCP Lease Table":["This won't help right now."],"Trace API Traffic from Flagged IP":["You filter network flow logs for the flagged IP.","Several API calls were routed through the Developer Hub with a few to undocumented endpoints.","Which destination node has had the highest interaction with the rogue IP and should be flagged for monitoring?"],CORRECT_ACTION:"Trace API Traffic from Flagged IP"},"research-lab":{"Trace MAC Address Conflicts":["This won't help right now."],"Analyze Network Throughput to Lab Nodes":["This won't help right now."],"Scan for Rogue Access Points":["This won't help right now."],"Review Scheduled Scripts":["This won't help right now."],CORRECT_ACTION:null}},se:{"developer-hub":{"Review Git Commit History":["This won't help right now."],"Trace Endpoint Access Logs":["This won't help right now."],"Review Classification Schema":["This won't help right now."],"Check Running Dev Services":["This won't help right now."],CORRECT_ACTION:null},"server-room":{"Audit Running Processes for Anomalies":["You scan the server’s running processes for unusual memory usage, privilege elevation, and unsigned binaries.","One process doesn’t match any verified signatures and is using significantly more resources than the rest.","Which process should be flagged for investigation?"],"Review Microservice Startup Logs":["This won't help right now."],"Check Runtime Errors on Backend Services":["This won't help right now."],"Validate Service Dependencies":["This won't help right now."],CORRECT_ACTION:"Audit Running Processes for Anomalies"},"research-lab":{"Investigate Foreign Key Mismatch":["This won't help right now."],"Review Git Commit History":["You open the commit logs from the last deployment window.","One commit stands out. It modified a crucial dataset used by the AI in production.","You flag it for rollback and notify the Data Scientist to help clean up the mess.","Which git commit did you flag?"],"Review Model Execution Logs":["This won't help right now."],"Review Active Class Overrides":["This won't help right now."],CORRECT_ACTION:"Review Git Commit History"},"command-centre":{"Scan for Unsecured Internal APIs":["This won't help right now."],"Trigger Class Hierarchy Scan":["This won't help right now."],"Review CI/CD Deployment Logs":["This won't help right now."],"Audit Token Usage in System Services":["This won't help right now."],CORRECT_ACTION:null}},ds:{"server-room":{"Analyse Model Resource Usage":["This won't help right now."],"Check Model Serving Latency":["This won't help right now."],"Run Feature Engineering Audit":["This won't help right now."],"Inspect Containerized Model Deployments":["This won't help right now."],CORRECT_ACTION:null},"command-centre":{"Adjust Intrusion Detection Signals":["This won't help right now."],"Review Alert Thresholds for Data Anomalies":["This won't help right now."],"Commence An Exploratory Data Analysis Session":["Early analysis results show wild predictions by models that were previously operating correctly.","A quick check of the summary stats reveals the issue.","What’s the best cleaning approach to prevent downstream failures caused by this commit?"],"Audit Scheduled Retraining Jobs":["This won't help right now."],CORRECT_ACTION:"Commence An Exploratory Data Analysis Session"},"developer-hub":{"Verify Data Pipeline Integrity":["This won't help right now."],"Inspect Feature Store Activity":["This won't help right now."],"Analyse User Session Logs":["You load 24 hours of user session logs and run statistical comparisons across key behavioral metrics.","One user shows a clear deviation with unusual access frequency, irregular login times, and inconsistent device usage.","What user is this?"],"Audit Prediction Rules":["This won't help right now."],CORRECT_ACTION:"Analyse User Session Logs"},"research-lab":{"Review Training Data Samples":["This won't help right now."],"Check Dataset Integrity and Labeling":["This won't help right now."],"Analyze Experiment Metrics for Outliers":["This won't help right now."],"Compare Performance of Experimental Models":["This won't help right now."],CORRECT_ACTION:null}}},2:{ca:{"server-room":{"Investigate Server Traffic Logs":["This won't help right now."],"Check Firewall Configuration":["This won't help right now."],"Review Active Directory Logs":["This won't help right now."],"Analyse Authentication Logs":["This won't help right now."],CORRECT_ACTION:null},"command-centre":{"Trace Endpoint Behavior by Class":["You scan endpoints reporting custom subclass behavior.","The Software Engineer flagged a specific subclass as malicious, likely injecting commands remotely.","Which endpoint is most likely being controlled by the injected subclass?"],"Update Threat Intelligence Feeds":["This won't help right now."],"Cross-check Audit Trail Against Global Events":["This won't help right now."],"Patch Exposed Service":["This won't help right now."],CORRECT_ACTION:"Trace Endpoint Behavior by Class"},"developer-hub":{"Review Access Control File":["This won't help right now."],"Check Developer Login Tokens":["This won't help right now."],"Trigger Endpoint Containment Protocol":["You launch the containment protocol, scanning logs for suspicious internal activity.","Several machines are acting strangely. Service accounts behaving outside normal baselines.","Which of these endpoints is most likely under AI control and should be isolated immediately?"],"Analyze Recent API Security Logs":["This won't help right now."],CORRECT_ACTION:"Trigger Endpoint Containment Protocol"},"research-lab":{"Review Email Gateway Rules":["This won't help right now."],"Look Up User Activity History":["This won't help right now."],"Reboot Threat Detection System":["This won't help right now."],"Run Network Speed Diagnostics":["This won't help right now."],CORRECT_ACTION:null}},ne:{"server-room":{"Audit Monitoring Scripts":["You inspect your batch scripts used for intrusion detection across endpoints.","Which monitoring script must be patched to remove reliance on the leaky feature the Data Scientist flagged?"],"Reconfigure VLAN Assignments":["This won't help right now."],"Check UPS and Cooling Network Interfaces":["This won't help right now."],"Patch Firewall Configuration":["This won't help right now."],CORRECT_ACTION:"Audit Monitoring Scripts"},"command-centre":{"Review Network Topology Diagrams":["This won't help right now."],"Analyse Firewall Logs":["This won't help right now."],"Review Recent Script Executions":["This won't help right now."],"Compare Interface Access Logs":["This won't help right now."],CORRECT_ACTION:null},"developer-hub":{"Audit Static IP Assignments":["This won't help right now."],"Check Network Mapping for Dev Machines":["This won't help right now."],"Monitor DHCP Lease Table":["This won't help right now."],"Trace API Traffic from Flagged IP":["This won't help right now."],CORRECT_ACTION:null},"research-lab":{"Trace MAC Address Conflicts":["This won't help right now."],"Analyze Network Throughput to Lab Nodes":["This won't help right now."],"Scan for Rogue Access Points":["This won't help right now."],"Review Scheduled Scripts":["You initiate a trace on all active and scheduled jobs running in the research lab.","A list of batch scripts lights up on the console. Most look routine, but one stands out.","Something's injecting data regularly... and it's not coming from any known system.","Which script is most likely responsible?"],CORRECT_ACTION:"Review Scheduled Scripts"}},se:{"developer-hub":{"Review Git Commit History":["This won't help right now."],"Trace Endpoint Access Logs":["This won't help right now."],"Review Classification Schema":["This won't help right now."],"Check Running Dev Services":["This won't help right now."],CORRECT_ACTION:null},"server-room":{"Audit Running Processes for Anomalies":["This won't help right now."],"Review Microservice Startup Logs":["This won't help right now."],"Check Runtime Errors on Backend Services":["This won't help right now."],"Validate Service Dependencies":["This won't help right now."],CORRECT_ACTION:null},"research-lab":{"Investigate Foreign Key Mismatch":["This won't help right now."],"Review Git Commit History":["This won't help right now."],"Review Model Execution Logs":["This won't help right now."],"Review Active Class Overrides":["You scan recently modified classes in the build pipeline.","One of them originates from the compromised developer machine flagged earlier.","Which class has most likely been modified by the AI and should be deprecated immediately?"],CORRECT_ACTION:"Review Active Class Overrides"},"command-centre":{"Scan for Unsecured Internal APIs":["This won't help right now."],"Trigger Class Hierarchy Scan":["You launch a scan of active subclasses extending from core system services.","One of them is behaving differently. It's injecting logic at runtime from an unknown source.","Which subclass most likely introduces AI-modified behavior and should be flagged?"],"Review CI/CD Deployment Logs":["This won't help right now."],"Audit Token Usage in System Services":["This won't help right now."],CORRECT_ACTION:"Trigger Class Hierarchy Scan"}},ds:{"server-room":{"Analyze Model Resource Usage":["This won't help right now."],"Check Model Serving Latency":["This won't help right now."],"Run Feature Engineering Audit":["You audit the engineered features feeding into the real-time detection model.","One of them has an unusually high correlation with intrusion events. Suspiciously high...","Which engineered feature is likely causing data leakage in the intrusion detection model?"],"Inspect Containerized Model Deployments":["This won't help right now."],CORRECT_ACTION:"Run Feature Engineering Audit"},"command-centre":{"Analyse Feature Stability Report":["You compare the variance and update timings of key engineered features.","One of them lines up exactly with the suspicious script injected earlier.","Which feature is most likely impacted by the corrupted automation script and should be excluded from modeling?"],"Review Alert Thresholds for Data Anomalies":["This won't help right now."],"Commence An Exploratory Data Analysis Session":["This won't help right now."],"Audit Scheduled Retraining Jobs":["This won't help right now."],CORRECT_ACTION:"Analyse Feature Stability Report"},"developer-hub":{"Verify Data Pipeline Integrity":["This won't help right now."],"Inspect Feature Store Activity":["This won't help right now."],"Analyse User Session Logs":["This won't help right now."],"Audit Prediction Rules":["This won't help right now."],CORRECT_ACTION:null},"research-lab":{"Review Training Data Samples":["This won't help right now."],"Check Dataset Integrity and Labeling":["This won't help right now."],"Analyze Experiment Metrics for Outliers":["This won't help right now."],"Compare Performance of Experimental Models":["This won't help right now."],CORRECT_ACTION:null}}},3:{ca:{"server-room":{"Investigate Server Traffic Logs":["This won't help right now."],"Check Firewall Configuration":["This won't help right now."],"Review Active Directory Logs":["This won't help right now."],"Analyse Authentication Logs":["You load the latest authentication dump from `/var/log/auth.log`.","Multiple service accounts show signs of compromise but one is clearly AI-controlled.","Which account is most likely being exploited by the AI to compromise data security?"],CORRECT_ACTION:"Analyse Authentication Logs"},"command-centre":{"Trace Endpoint Behavior by Class":["This won't help right now."],"Update Threat Intelligence Feeds":["This won't help right now."],"Cross-check Audit Trail Against Global Events":["This won't help right now."],"Patch Exposed Service":["You open the config file of the app-layer service identified by the Network Engineer.","It’s wide open. No auth, no rate limiting, open to the whole internet.","Which patch would best prevent a repeat of the AI's data breach?"],CORRECT_ACTION:"Patch Exposed Service"},"developer-hub":{"Review Access Control File":["This won't help right now."],"Check Developer Login Tokens":["This won't help right now."],"Trigger Endpoint Containment Protocol":["This won't help right now."],"Analyze Recent API Security Logs":["This won't help right now."],CORRECT_ACTION:null},"research-lab":{"Review Email Gateway Rules":["This won't help right now."],"Look Up User Activity History":["This won't help right now."],"Reboot Threat Detection System":["This won't help right now."],"Run Network Speed Diagnostics":["This won't help right now."],CORRECT_ACTION:null}},ne:{"server-room":{"Audit Monitoring Scripts":["You inspect your batch scripts used for intrusion detection across endpoints.","Which monitoring script must be patched to remove reliance on the leaky feature the Data Scientist flagged?"],"Reconfigure VLAN Assignments":["This won't help right now."],"Check UPS and Cooling Network Interfaces":["This won't help right now."],"Patch Firewall Configuration":["You receive an exploit signature from the Software Engineer. Malformed foreign keys like are slipping into analytics systems.","You draft several rule candidates for outbound traffic filtering.","Which rule should you apply to stop this behavior?"],CORRECT_ACTION:"Patch Firewall Configuration"},"command-centre":{"Review Network Topology Diagrams":["This won't help right now."],"Analyse Firewall Logs":["You receive a time-synced firewall log excerpt showing AI-originating traffic.","One of these protocols was used to exfiltrate internal system logs.","Which breach vector is responsible?"],"Review Recent Script Executions":["This won't help right now."],"Compare Interface Access Logs":["This won't help right now."],CORRECT_ACTION:"Analyse Firewall Logs"},"developer-hub":{"Audit Static IP Assignments":["This won't help right now."],"Check Network Mapping for Dev Machines":["This won't help right now."],"Monitor DHCP Lease Table":["This won't help right now."],"Trace API Traffic from Flagged IP":["This won't help right now."],CORRECT_ACTION:null},"research-lab":{"Trace MAC Address Conflicts":["This won't help right now."],"Analyze Network Throughput to Lab Nodes":["This won't help right now."],"Scan for Rogue Access Points":["This won't help right now."],"Review Scheduled Scripts":["This won't help right now."],CORRECT_ACTION:null}},se:{"developer-hub":{"Review Git Commit History":["This won't help right now."],"Trace Endpoint Access Logs":["This won't help right now."],"Review Classification Schema":["You load the `security_flags` table in the dashboard.","Everything looks valid at a glance, but something isn’t matching up. The AI’s allowed several malicious users to slip through.","What structural flaw could allow malicious records to bypass classification?"],"Check Running Dev Services":["This won't help right now."],CORRECT_ACTION:"Review Classification Schema"},"server-room":{"Audit Running Processes for Anomalies":["This won't help right now."],"Review Microservice Startup Logs":["This won't help right now."],"Check Runtime Errors on Backend Services":["This won't help right now."],"Validate Service Dependencies":["This won't help right now."],CORRECT_ACTION:null},"research-lab":{"Investigate Foreign Key Mismatch":["You pull the database schema for the `security_flags` table and cross-reference it with the anomaly log.","One of the foreign key references is allowing invalid data to slip through unchecked.","Which field is being misused?"],"Review Git Commit History":["This won't help right now."],"Review Model Execution Logs":["This won't help right now."],"Review Active Class Overrides":["This won't help right now."],CORRECT_ACTION:"Investigate Foreign Key Mismatch"},"command-centre":{"Scan for Unsecured Internal APIs":["This won't help right now."],"Trigger Class Hierarchy Scan":["You launch a scan of active subclasses extending from core system services.","One of them is behaving differently, injecting logic at runtime from an unknown source.","Which subclass most likely introduces AI-modified behavior and should be flagged?"],"Review CI/CD Deployment Logs":["This won't help right now."],"Audit Token Usage in System Services":["This won't help right now."],CORRECT_ACTION:"Trigger Class Hierarchy Scan"}},ds:{"server-room":{"Analyze Model Resource Usage":["This won't help right now."],"Check Model Serving Latency":["This won't help right now."],"Run Feature Engineering Audit":["You audit the engineered features feeding into the real-time detection model.","One of them has an unusually high correlation with intrusion events. Suspiciously high...","Which engineered feature is likely causing data leakage in the intrusion detection model?"],"Inspect Containerized Model Deployments":["This won't help right now."],CORRECT_ACTION:"Run Feature Engineering Audit"},"command-centre":{"Analyse Feature Stability Report":["You compare the variance and update timings of key engineered features.","One of them lines up exactly with the suspicious script injected earlier.","Which feature is most likely impacted by the corrupted automation script and should be excluded from modeling?"],"Review Alert Thresholds for Data Anomalies":["This won't help right now."],"Commence An Exploratory Data Analysis Session":["This won't help right now."],"Audit Scheduled Retraining Jobs":["This won't help right now."],CORRECT_ACTION:"Analyse Feature Stability Report"},"developer-hub":{"Verify Data Pipeline Integrity":["This won't help right now."],"Inspect Feature Store Activity":["This won't help right now."],"Analyse User Session Logs":["This won't help right now."],"Audit Prediction Rules":["You review the simplified logic extracted from the AI’s current decision engine.","One rule is causing a spike in false positives, even for clean endpoint activity.","Which line is most likely responsible?"],CORRECT_ACTION:"Audit Prediction Rules"},"research-lab":{"Review Training Data Samples":["You pull a subset of recent training data used in real-time anomaly detection.","One of them appears mislabeled, likely injected by the flagged account.","Which sample index is most likely poisoned?"],"Check Dataset Integrity and Labeling":["This won't help right now."],"Analyze Experiment Metrics for Outliers":["This won't help right now."],"Compare Performance of Experimental Models":["This won't help right now."],CORRECT_ACTION:"Review Training Data Samples"}}},"NO-ACTION":["This doesn't seem to help right now. You should try looking in some other rooms."]},Dt={1:{ca:{"server-room":{enabler:{title:"Identify Rougue IP Address",prompt:`Review the captured traffic log below. Which IP address most likely belongs to the rogue AI and must be urgently reviewed?
<pre><code class="language-bash">[09:21:03] 10.0.0.45 → Server_1: Routine status check
[09:21:07] 172.16.5.12 → Developer_Hub: Multiple authentication attempts failed
[09:21:10] 10.0.0.77 → Research_Lab: Large encrypted data transfer initiated
[09:21:15] 192.168.3.200 → Server_Room: Rapid port scanning detected</code></pre>`,hint:"As a Cybersecurity Analyst, you're trained to recognize active reconnaissance behaviors. A 'port scan' typically signals an attempt to map open services on a target, an early phase in most attacks.",tableHeaders:["Option"],tableRows:[["10.0.0.45"],["172.16.5.12"],["10.0.0.77"],["192.168.3.200"]],correctAnswerIndex:3,feedback:{correct:["An external IP triggering a port scan alert is the digital equivalent of someone rattling every doorknob in your building at 3AM.","Whether it’s the AI itself or an AI-controlled node, this is the clearest sign of an automated threat in action.","It’s not guessing passwords or hiding in traffic... it’s hunting.","You send the IP address to the network engineer for urgent review.","You should investigate some other rooms in case you can assist further."],incorrect:["You send the IP address to the network engineer for urgent review.","You should investigate some other rooms in case you can assist further."]}}},"research-lab":{enabled:{title:"Idenfity Suspicious Login Attempt",prompt:`Review the server login log excerpt below. Which IP address confirms the Data Scientist’s suspicion of a compromised account?
<pre><code class="language-bash">[2025-07-01 02:12:43] 192.168.1.10 — DevStation01 (Melbourne): Login Success
[2025-07-01 02:14:05] 203.0.113.55 — Unknown Device (Tokyo): Login Success
[2025-07-01 02:14:22] 192.168.1.10 — DevStation01 (Melbourne): Active Session
[2025-07-01 02:15:10] 192.168.1.12 — DataNode03 (Melbourne): Login Success</code></pre>`,hint:"As a Cybersecurity Analyst, you monitor for anomalous login patterns. A successful login from a foreign location, especially squeezed between local sessions, suggests account compromise or session hijacking.",tableHeaders:["IP Address"],tableRows:[["192.168.1.10"],["203.0.113.55"],["192.168.1.10"],["192.168.1.12"]],correctAnswerIndex:1,feedback:{correct:["The login pattern shows a classic sign of account compromise. An external IP slipping in between legitimate internal logins.","Even if the credentials were correct, the location, device, or timing should raise red flags.","This isn’t just a user on a VPN. It’s likely the Rogue AI probing for elevated access or persistence.","You’ve flagged the user as compromised.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You flag the user as compromised.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}},ne:{"command-centre":{enabler:{title:"Identify Compromised Interface",prompt:'Review the interface diagnostics log below. One of these interfaces shows clear signs of AI infiltration. Which one?<br><pre><code class="language-none">Interface Report — July 1, 2025<br>----------------------------------<br>eth0:<br>  - Avg. Traffic: 200 MB<br>  - Recent Traffic: 195 MB<br>  - Protocols: SSH, HTTP<br><br>eth1:<br>  - Avg. Traffic: 150 MB<br>  - Recent Traffic: 580 MB<br>  - Protocols: SSH, TCP, Unknown<br><br>eth2:<br>  - Avg. Traffic: 300 MB<br>  - Recent Traffic: 310 MB<br>  - Protocols: FTP, SMB<br><br>eth3:<br>  - Avg. Traffic: 180 MB<br>  - Recent Traffic: 175 MB<br>  - Protocols: DNS, NTP</code></pre>',hint:"As a Network Engineer, you compare expected traffic baselines to actual usage. Unusual spikes and unknown protocols on an interface often indicate unauthorized communication or breach activity.",tableHeaders:["Interface"],tableRows:[["eth0"],["eth1"],["eth2"],["eth3"]],correctAnswerIndex:1,feedback:{correct:["eth1’s lighting up like a Christmas tree.","Way above normal traffic, and something’s talking on an unknown protocol.","That’s not just noise, that’s a breach vector.","You flag it for follow-up by the Software Engineer.","You should investigate some other rooms in case you can assist further."],incorrect:["You flag the interace for follow-up.","You should investigate some other rooms in case you can assist further."]}}},"developer-hub":{enabled:{title:"Identify Infected Nodes",prompt:`Analyze the AI's communication trace. Which node has the flagged IP interacted with the most?<br><pre><code class="language-none">Connection Trace<br>--------------------------<br>Destination IP     Protocol     Count   Time Since Last Seen<br>192.168.1.20       ICMP         5       3 hours ago<br>192.168.2.10       TCP          4       Over 1 week ago<br>192.168.3.40       UDP          0       -<br>192.168.3.200      TCP         13       47 seconds ago<br>10.0.0.45          TCP          3       2 hours ago</code></pre>`,hint:"You're used to tracing communication patterns. Frequent, recent contact with a suspicious IP (especially across TCP) usually signals a node being used for persistence or command-and-control.",tableHeaders:["IP Address"],tableRows:[["192.168.1.20"],["192.168.2.10"],["192.168.3.40"],["192.168.3.200"],["10.0.0.45"]],correctAnswerIndex:3,feedback:{correct:["192.168.3.200 shows the most consistent interaction with the flagged IP.","This node has been contacted repeatedly, and its location deep in the network makes it a perfect bridge for lateral movement.","You isolate the destination paths in attempt to block future connections.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You flagged the node for monitoring.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}},se:{"research-lab":{enabler:{title:"Identify Issue Git Commit",prompt:'Review the recent commit history. Which commit most likely introduced poisoned data that corrupted the AI’s behavior?<br><pre><code class="language-none">Git Log Summary<br>----------------------------------------------------------<br>Commit ID   | Message                                 | Effect<br>----------------------------------------------------------<br>AA12        | Skip null checks in value multiplier     | May introduce NaNs downstream<br>ZZ93        | Hardcode values temporarily for testing   | Inserts extreme outliers, can poison ML models<br>YY54        | Convert input to string for log display   | Type mismatch risk in pipelines<br>BB38        | Add optional status field                 | Adds flexibility, no core risk</code></pre>',hint:"As a Software Engineer, you know how model performance can be impacted by code changes. Commits that introduce test values, especially extreme ones, can corrupt training data and model logic.",tableHeaders:["Commit ID"],tableRows:[["AA12"],["ZZ93"],["YY54"],["BB38"]],correctAnswerIndex:1,feedback:{correct:["Commit ZZ93 introduces a malicious hardcoded value that could poison training data.","This is likely how the AI's logic was corrupted.","You’ve flagged the commit to be investigated by the Data Scientist.","You should investigate some other rooms in case you can assist further."],incorrect:["You’ve flagged the commit to be investigated by the Data Scientist.","You should investigate some other rooms in case you can assist further."]}}},"server-room":{enabled:{title:"Identify Infected Process",prompt:'Review the system diagnostics below. Which process is most likely infected by the AI and should be contained immediately?<br><pre><code class="language-none">Process Diagnostics Snapshot<br>--------------------------------------------------------------<br>Process Name   | Interface | Memory Usage | Hash Verified<br>--------------------------------------------------------------<br>db_sync        | eth0      | 20 MB        | Yes<br>log_agent      | eth1      | 32 MB        | Yes<br>systemd-1      | eth1      | 300 MB       | No<br>cache_clean    | eth2      | 28 MB        | Yes</code></pre>',hint:"You're trained to recognize system-level anomalies. A legitimate-sounding process consuming excessive memory and failing hash verification could be the AI masquerading as a core service.",tableHeaders:["Process"],tableRows:[["db_sync"],["log_agent"],["systemd-1"],["cache_clean"]],correctAnswerIndex:2,feedback:{correct:["That’s not the real systemd process. It’s consuming 10x normal memory, and it’s not even hash-verified.","The AI’s likely masquerading behind it.","You flag `systemd-1` for code review and containment trace.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You flagged the process for review.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}},ds:{"developer-hub":{enabler:{title:"Identify Compromised Account",prompt:`Review the session activity report below. Which account has most likely been exploited by the AI to access the server?<br><pre><code class="language-none">User Activity Summary
--------------------------------------------------------------
User ID   | Session Count | Avg. Actions | Peak Memory (MB)
--------------------------------------------------------------
user_01   | 4             | 3.2          | 420
user_02   | 5             | 3.5          | 390
user_03   | 4             | 3.0          | 405
user_99   | 2             | 15.2         | 950</code></pre>`,hint:"As a Data Scientist, you rely on behavior profiling. When one user shows drastically higher memory usage and activity rates than peers, it's often an outlier worth flagging as anomalous.",tableHeaders:["Account"],tableRows:[["user_01"],["user_02"],["user_03"],["user_99"]],correctAnswerIndex:3,feedback:{correct:["User `user_99` is acting nothing like the others.","Double the memory, five times the activity rate, that’s not just fast typing, that’s non-human.","Flagging for escalation by the Cyber Security Analyst.","You should investigate some other rooms in case you can assist further."],incorrect:["You flag the user for escalation by the Cyber Security Analyst.","You should investigate some other rooms in case you can assist further."]}}},"command-centre":{enabled:{title:"Utilise Correct Data Cleaning Technique",prompt:'You receive a dataset for model input. One of the features is shown below:<br><pre><code class="language-python">feature_4 = [5, 6, 7, 8, 6, 5, 120, 7, 6, 8]</code></pre>What cleaning step is most appropriate before feeding this into a machine learning model?',hint:"You're skilled in preparing data for modeling. Outliers like extremely large values can skew predictions (especially in small datasets), so detection and treatment are crucial preprocessing steps.",tableHeaders:["Cleaning Step"],tableRows:[["Drop or impute missing values"],["Remove or clip outliers"],["Cast to numeric type"],["No cleaning needed"]],correctAnswerIndex:1,feedback:{correct:["Extreme outliers like these can completely destabilise models, especially if they weren’t expected in training.","Clipping or removing them prevents the AI from learning skewed patterns or reacting to poisoned inputs.","You clean the data and flag the commit.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You put your expertise into action and resolve the issue.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}}},2:{ca:{"developer-hub":{enabler:{title:"Isolate AI-Controlled Endpoint",prompt:`Review the system logs below. Which of these endpoints is most likely under AI control and should be isolated immediately?<br><pre style='font-family: monospace; font-size: 13px;'><code>Time       | Device ID | User        | Activity Summary
--------------------------------------------------------------
14:22:01   | DEV-045   | jsimons     | Attempted to disable OS-level firewall
14:22:03   | DEV-312   | svc_deploy  | Established 9 simultaneous outbound SSH sessions
14:22:08   | DEV-229   | root        | Launched code-signing tool without valid certificate
14:22:11   | DEV-088   | svc_devbuild| Repeated privilege escalation attempts on internal APIs</code></pre>`,hint:"As a Cybersecurity Analyst, you know that abnormal service account behavior like launching many outbound SSH sessions is often a sign of lateral movement or system compromise.",tableHeaders:["Option"],tableRows:[["DEV-045"],["DEV-312"],["DEV-229"],["DEV-088"]],correctAnswerIndex:1,feedback:{correct:["Nine simultaneous outbound SSH sessions from a service account is highly suspicious and a classic lateral movement pattern.","This endpoint is likely under AI control and actively breaching internal dev tools.","You package the device ID and account details and send them to the Software Engineer for hard quarantine.","You should investigate some other rooms in case you can assist further."],incorrect:["You package the device ID and account details and send them to the Software Engineer for hard quarantine.","You should investigate some other rooms in case you can assist further."]}}},"command-centre":{enabled:{title:"Isolate Subclass-Controlled Endpoint",prompt:`The AI appears to be leveraging a subclass injection technique. Review the diagnostic telemetry below. Which endpoint is most likely being controlled by the injected subclass?<br><pre style='font-family: monospace; font-size: 13px;'><code>Endpoint ID | Injected Class     | Cmd Frequency | Outbound Ports | Notes
--------------------------------------------------------------------------
E-221       | LoggerService      | Low           | 1              | Stable log activity
E-314       | CommandRelay       | High          | 6              | Unusual spike in command throughput
E-109       | TelemetryHandler   | Medium        | 2              | Polling interval slightly elevated
E-403       | HealthCheck        | Low           | 0              | No anomalous behavior</code></pre>`,hint:"You're familiar with how injected code can manifest. A subclass showing unusually high command throughput and many outbound ports is likely executing remote instructions.",tableHeaders:["Option"],tableRows:[["E-221"],["E-314"],["E-109"],["E-403"]],correctAnswerIndex:1,feedback:{correct:["`E-314` is linked directly to the injected class and shows a high command execution rate.","It’s accessing multiple outbound ports which is a clear indicator of remote instruction propagation.","You isolate the endpoint and notify the containment team to sever all outbound connections.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You isolate the selected endpoint and notify the containment team.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}},ne:{"research-lab":{enabler:{title:"Trace Malicious Scheduled Script",prompt:`You're reviewing scheduled scripts across the research network. One is suspected of injecting manipulated telemetry into sensitive systems.<br><pre style='font-family: monospace; font-size: 13px;'><code>Script ID   | Schedule     | Data Type           | Anomaly Rate | Triggered By
---------------------------------------------------------------------------
sched_001   | Every 5 min  | Temperature         | 0.3%         | SensorGroupA
sched_019   | On reboot    | Pressure            | 0.4%         | SensorGroupC
sched_112   | Every 10 min | Thermal + Pressure  | 8.9%         | Unknown
sched_072   | Manual       | Telemetry Sync      | 0.0%         | System Admin</code></pre>`,hint:"As a Network Engineer, you understand how scheduled tasks integrate with telemetry systems. Scripts triggered by unknown sources with high anomaly rates are often suspect.",tableHeaders:["Option"],tableRows:[["sched_001"],["sched_019"],["sched_112"],["sched_072"]],correctAnswerIndex:2,feedback:{correct:["`sched_112` is triggered by an unknown source and has an anomaly rate over 8%.","The script runs independently and pushes altered sensor data at regular intervals.","You flag it for investigation and send the anomaly pattern to the Data Scientist.","You should investigate some other rooms in case you can assist further."],incorrect:["You flag the script for further investigation.","You should investigate some other rooms in case you can assist further."]}}},"server-room":{enabled:{title:"Patch Faulty Monitoring Script",prompt:`You're auditing deployed monitoring scripts after the Data Scientist flagged a feature as leaky. It becomes valid *only after* an intrusion occurs, and should not be used for real-time monitoring. The last known intrusion occurred at **02:03**. Which script is relying on this flawed input?<br><pre style='font-family: monospace; font-size: 13px;'><code>Script Name            | Feature Used          | Last Run Time | Confidence Score
----------------------------------------------------------------------------------
endpoint_health.bat   | session_length        | 02:00         | 0.71
trace_login_flow.cmd  | login_error_count     | 02:02         | 0.68
intrusion_check.bat   | post_intrusion_flag   | 02:05         | 0.99
uptime_scan.cmd       | access_freq           | 02:01         | 0.55</code></pre>`,hint:"As a Network Engineer, your job is to ensure detection systems respond to threats as they happen. If a script runs after a known intrusion and uses a feature that only becomes valid post-incident, it's no longer providing real-time protection and should be removed or replaced.",tableHeaders:["Script"],tableRows:[["endpoint_health.bat"],["trace_login_flow.cmd"],["intrusion_check.bat"],["uptime_scan.cmd"]],correctAnswerIndex:2,feedback:{correct:["`intrusion_check.bat` is using a feature that is made available after an intrusion occurs.","Its near-perfect confidence score is misleading too, as it depends on the post-event feature.","That’s like saying “I knew a crime would happen” after watching it unfold. It’s not detection, it’s confirmation. Not very useful in this case.","You patch the script to use valid real-time signals and redeploy to all affected devices.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You patch the selected script and redeploy.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}},se:{"command-centre":{enabler:{title:"Trace Malicious Subclass Injection",prompt:`You're reviewing recent class definitions within the runtime environment. One subclass appears to override methods from its base class and is being instantiated by an unknown system. Which one is most likely introducing AI-modified behavior?<br><pre style='font-family: monospace; font-size: 13px;'><code>Class Name       | Base Class     | Overrides Method? | Instantiated By | Behavior Notes
----------------------------------------------------------------------------------------
TelemetryHandler | DeviceService  | Yes               | CoreSystem      | Standard data polling
CommandRelay     | DeviceService  | Yes               | Unknown         | Injects dynamic runtime instructions
HealthCheck      | SystemMonitor  | No                | CoreSystem      | Runs at fixed intervals
LoggerService    | DeviceService  | No                | DevTools        | Logs standard operations</code></pre>`,hint:"As a Software Engineer, you know class hierarchies define inherited behavior. When a subclass overrides a method, it replaces core functionality. If that subclass is also being created by an unknown source, it could inject malicious behavior while appearing legitimate.",tableHeaders:["Option"],tableRows:[["TelemetryHandler"],["CommandRelay"],["HealthCheck"],["LoggerService"]],correctAnswerIndex:1,feedback:{correct:["The `CommandRelay` class overrides `DeviceService` but is instantiated by an unknown source which is highly suspicious.","Its dynamic instruction injection is a major red flag for AI tampering.","You flag this subclass for containment and notify the Cyber Security Analyst for downstream impact analysis.","You should investigate some other rooms in case you can assist further."],incorrect:["You flag this subclass for review and containment.","You should investigate some other rooms in case you can assist further."]}}},"research-lab":{enabled:{title:"Identify Compromised Class",prompt:`The AI has likely injected code into one of the runtime classes. Review the compilation report below and determine which class is most likely compromised.<br><pre style='font-family: monospace; font-size: 13px;'><code>Class Name       | Origin IP   | Overrides Base? | Active Instances | Notes
-------------------------------------------------------------------------------
TelemetryBase    | 10.1.2.17   | Yes             | 3                | Used by legacy sensors
JobRunner        | 10.1.2.56   | Yes             | 84               | Recompiled last 2 hours ago
LoggerHelper     | 127.0.0.1   | No              | 12               | No recent changes
AuthManager      | 10.1.2.78   | Yes             | 6                | Deprecated in latest build</code></pre>`,hint:"You recognize that frequent instantiation, recent compilation, and suspicious origins are signs of runtime compromise. These are common traits of AI-modified or backdoored classes.",tableHeaders:["Option"],tableRows:[["TelemetryBase"],["JobRunner"],["LoggerHelper"],["AuthManager"]],correctAnswerIndex:1,feedback:{correct:["The `JobRunner` class originated from the compromised machine and was recompiled recently.","It overrides base methods and is being instantiated far more than expected. Classic signs of injection.","You flag it for immediate deprecation and isolate it from the build process.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You flag the class for review and quarantine.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}},ds:{"server-room":{enabler:{title:"Flag Leaky Feature",prompt:`The intrusion detection model is showing unusually high performance, too good to be true. Review the engineered feature metadata below and identify which feature is causing data leakage.<br><pre style='font-family: monospace; font-size: 13px;'><code>Feature Name         | Derived From       | Correlation | Generated At        | Notes
----------------------------------------------------------------------------------------------
session_length       | Login timestamp    | 0.15        | Start of session    | Standard behavioral metric
login_error_count    | Syslog messages    | 0.23        | During session      | Stable, moderately predictive
post_intrusion_flag  | Audit logs         | 0.97        | After incident      | High correlation but post-event
access_freq          | Access logs        | 0.29        | Start of session    | Stable signal</code></pre>`,hint:"As a Data Scientist, you must detect data leakage in features. A variable generated after the event it's predicting artificially inflates accuracy and must be excluded from training.",tableHeaders:["Option"],tableRows:[["session_length"],["login_error_count"],["post_intrusion_flag"],["access_freq"]],correctAnswerIndex:2,feedback:{correct:["`post_intrusion_flag` is generated after the incident occurs... textbook data leakage.","It’s highly predictive, but only because it includes post-event knowledge.","You flag this feature and send a report to the Network Engineer so they can patch the monitoring script that depends on this feature.","You should investigate some other rooms in case you can assist further."],incorrect:["You flag the feature for review and notify the Network Engineer.","You should investigate some other rooms in case you can assist further."]}}},"command-centre":{enabled:{title:"Isolate Poisoned Feature",prompt:`You've received a trace report linking a corrupted automation script to erratic sensor behavior. Review the feature metadata below to determine which signal is most likely compromised and should be excluded from modeling.<br><pre style='font-family: monospace; font-size: 13px;'><code>Feature         | Source        | Variance Spike | Missing Rate | Last Affected
-------------------------------------------------------------------------------
pressure_avg    | SensorGroupC  | 0.8%           | 0.2%          | Yesterday
temp_rate       | SensorGroupA  | 1.1%           | 1.3%          | 3 Days Ago
pressure_rate   | Unknown       | 13.4%          | 0.1%          | Last Hour
thermal_flux    | SensorGroupB  | 2.5%           | 0.0%          | Today</code></pre>`,hint:"You understand that erratic sensor behavior (especially with high variance and unclear sourcing) can poison models. Identifying the corrupted signal is key to restoring model integrity.",tableHeaders:["Option"],tableRows:[["pressure_avg"],["temp_rate"],["pressure_rate"],["thermal_flux"]],correctAnswerIndex:2,feedback:{correct:["`pressure_rate` is sourced from an unknown system, which is never a good sign.","It shows a massive spike in variance and was last updated within the last hour.","You exclude it from your next model iteration and begin auditing upstream transformations.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You exclude the feature and log it for review.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}}},3:{ca:{"server-room":{enabler:{title:"Detect AI-Driven Access Pattern",prompt:`Review the excerpt from the \`/var/log/auth.log\` below. Which service account is most likely being exploited by the AI to compromise data security?
<pre><code class="language-bash">Jul 14 12:03:21 node-17 login[2321]: user=svc_build success
Jul 14 12:03:21 node-17 login[2322]: user=svc_build success
Jul 14 12:03:21 node-17 login[2323]: user=svc_build success
Jul 14 12:03:22 node-17 login[2324]: user=svc_deploy failed
Jul 14 12:03:22 node-17 login[2325]: user=svc_deploy success
Jul 14 12:04:10 node-17 login[2326]: user=svc_metrics success
Jul 14 12:04:22 node-17 login[2327]: user=svc_backup success</code></pre>`,hint:"As a Cybersecurity Analyst, you spot behavioral anomalies. Multiple rapid logins from the same service account (especially within a single second) suggest automation, not human access.",tableHeaders:["Account"],tableRows:[["svc_deploy"],["svc_metrics"],["svc_backup"],["svc_build"]],correctAnswerIndex:3,feedback:{correct:["`svc_build` logs in three times within a single second. That’s a non-human pattern.","Its perfect timing and lack of variation suggest automation, likely AI-controlled.","You flag the account for credential revocation and send the pattern to the Data Scientist for behavior modeling.","You should investigate some other rooms in case you can assist further."],incorrect:["You flag the account for investigation.","You should investigate some other rooms in case you can assist further."]}}},"command-centre":{enabled:{title:"Patch Exposed Service",prompt:`You’ve been handed logs confirming the AI used TCP port 8080 to exfiltrate sensitive data. Review the service configuration below. Which patch action would best prevent this data breach?
<pre><code class="language-bash"># /etc/service_config/app-layer.conf
service_name=log_api
port=8080
auth_required=no
rate_limit=none
allowed_ips=0.0.0.0/0</code></pre>`,hint:"You're trained to harden exposed services. Allowing unrestricted IP access (0.0.0.0/0) creates a major risk, especially when combined with open ports and no authentication.",tableHeaders:["Patch Action"],tableRows:[["Change port to 443"],["Enable auth_required"],["Apply rate limiting"],["Restrict allowed_ips to 192.168.0.0/16"]],correctAnswerIndex:3,feedback:{correct:["Restricting access to trusted IPs (192.168.0.0/16) stops the AI from hitting the exposed endpoint.","The original config allowed anyone from anywhere, no auth or limit, making it perfect for exploitation.","You update the config and commit changes to the container deployment.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You apply the selected patch and flag the service for further monitoring.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}},ne:{"command-centre":{enabler:{title:"Trace Firewall Breach Path",prompt:`You’ve been asked to review recent firewall logs to identify which configuration allowed the AI to exfiltrate sensitive logs.
<pre><code class="language-bash">[ALERT] Jul 15 04:12:32 ACCEPT tcp -- 10.0.0.23:445 -> 172.16.5.10:8080 [flags ACK]
[ALERT] Jul 15 04:12:33 DROP tcp -- 10.0.0.23:445 -> 172.16.5.10:443 [flags SYN]
[ALERT] Jul 15 04:12:34 ACCEPT udp -- 10.0.0.23:53 -> 172.16.5.1:53 [DNS request]
[ALERT] Jul 15 04:12:35 ACCEPT tcp -- 10.0.0.23:445 -> 172.16.5.10:8080 [flags PSH,ACK]  → 1.4 MB transferred</code></pre>`,hint:"As a Network Engineer, you examine firewall logs for data exfiltration. Look for large payloads sent through accepted ports, especially those not meant for external exposure.",tableHeaders:["Breach Vector"],tableRows:[["TCP port 443 (HTTPS)"],["UDP port 53 (DNS)"],["TCP port 8080 (App Layer)"],["TCP port 445 (SMB)"]],correctAnswerIndex:2,feedback:{correct:["Port 8080 (App Layer) was repeatedly accepted, and a 1.4 MB payload was transmitted. This is likely the log dump.","That port is normally used by web APIs and should’ve been restricted for internal-only traffic.","You flag this as the breach path and forward the trace to the Cybersecurity Analyst.","You should investigate some other rooms in case you can assist further."],incorrect:["You flag the vector for review and internal audit.","You should investigate some other rooms in case you can assist further."]}}},"server-room":{enabled:{title:"Block Exploit at Firewall Level",prompt:`You’ve received a patch note about an invalid \`user_id\` being injected into the \`security_flags\` table.
Review the current firewall rule candidates below. Which one is best suited to block outbound transmissions resulting from this malformed data injection?
<pre><code class="language-bash">Rule 1: DROP tcp -- any -> db_server port 5432 flags RST
Rule 2: REJECT tcp -- any -> analytics_server port 8080 if payload contains 'user_id=9999'
Rule 3: ACCEPT tcp -- any -> db_server port 5432 established
Rule 4: DROP udp -- any -> analytics_server port 8080</code></pre>`,hint:"You understand how to construct rules that intercept specific exploit patterns. Dropping traffic containing known malicious payloads is more precise than blocking general port activity.",tableHeaders:["Rule #"],tableRows:[["1"],["2"],["3"],["4"]],correctAnswerIndex:1,feedback:{correct:["Rule 2 explicitly blocks any payloads containing the known exploit pattern (`user_id=9999`) targeting the analytics pipeline.","That’s exactly what’s needed to catch the malformed records flagged by the Software Engineer.","You apply the rule and initiate a downstream traffic monitor.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You apply the selected rule and schedule a monitor.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}},se:{"research-lab":{enabler:{title:"Trace Foreign Key Exploit",prompt:`Review the table definition and recent anomaly log below. Which foreign key relationship is most likely being exploited by the AI to bypass classification filters?
<pre><code class="language-sql">-- security_flags table
CREATE TABLE security_flags (
    id INT PRIMARY KEY,
    user_id INT,
    flag_code VARCHAR(10),
    timestamp TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (flag_code) REFERENCES flags(code)
);

-- anomaly log
[ALERT] Row inserted with user_id = 9999
[ERROR] No matching user found
[INFO] Flag still processed by downstream system</code></pre>`,hint:"As a Software Engineer, you're trained to design schemas that enforce relational integrity. If records are being inserted with no matching parent entry, the foreign key isn’t being properly enforced, which is a major vulnerability in classification workflows.",tableHeaders:["Field"],tableRows:[["id"],["user_id"],["flag_code"],["timestamp"]],correctAnswerIndex:1,feedback:{correct:["`user_id` is the foreign key in question. The AI is injecting IDs that don’t exist in the users table.","Despite the relational mismatch, the downstream pipeline still accepts the record.","You flag this FK logic gap and forward a patch request to the Network Engineer for downstream validation hardening.","You should investigate some other rooms in case you can assist further."],incorrect:["You flag the selected field for review and forward the report.","You should investigate some other rooms in case you can assist further."]}}},"developer-hub":{enabled:{title:"Patch AI Classification Filter",prompt:`The AI has modified internal classification logic to allow malicious users to pass as safe. Review the table schemas below. Which database issue is allowing compromised users to bypass the AI’s filters?
<pre><code class="language-sql">Table: security_flags
+--------------+----------+----------+----------------+
| Column Name  | Type     | Nullable | Foreign Key     |
+--------------+----------+----------+----------------+
| id           | INT      | NO       | —              |
| user_id      | VARCHAR  | NO       | users.id       |
| flag_type    | TEXT     | NO       | —              |
| confidence   | FLOAT    | YES      | —              |
| label        | TEXT     | YES      | —              |
+--------------+----------+----------+----------------+

Table: users
+-------------+-----------+----------+
| Column Name | Type      | Nullable |
+-------------+-----------+----------+
| user_id     | VARCHAR   | NO       |
| username    | TEXT      | NO       |
| created_at  | TIMESTAMP | NO       |
+-------------+-----------+----------+</code></pre>`,hint:"You understand that a schema mismatch (such as referencing a non-existent key) can break filtering logic. AI may use this to sneak malicious data through undetected.",tableHeaders:["Issue"],tableRows:[["Missing NOT NULL on label column"],["Unindexed foreign key on user_id"],["Mismatched type in flag_type column"],["Invalid reference to non-existent users.id"]],correctAnswerIndex:3,feedback:{correct:["`user_id` refers to `users.id`, but `users.id` doesn’t exist so the foreign key is invalid.","The AI used this broken reference to inject orphaned flags that bypass user-level filtering.","You patch the schema and alert the Network Engineer to monitor queries against orphaned IDs.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You flag the schema issue for review.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}},ds:{"developer-hub":{enabler:{title:"Diagnose Faulty Model Logic",prompt:`Review the AI's simplified decision function below. One of these conditionals is likely responsible for a spike in false positives. Which one is the issue?
<pre><code class="language-python">def predict(input):
    if input["login_attempts"] &gt; 3:
        return "malicious"
    elif input["cpu_usage"] &gt; 80:
        return "malicious"
    elif input["antivirus_alerts"] > 0:
        return "safe"
    else:
        return "safe"</code></pre>`,hint:"As a Data Scientist, you must identify flawed logic in decision functions. Watch for inverted conditions where clearly malicious behavior is misclassified as safe.",tableHeaders:["Check #"],tableRows:[["1"],["2"],["3"],["4"]],correctAnswerIndex:2,feedback:{correct:["Line 3 misuses the presence of antivirus alerts, it's logically inverted.","It causes compromised users with antivirus warnings to be flagged as safe.","You isolate the logic flaw and send it to the Software Engineer for patching.","You should investigate some other rooms in case you can assist further."],incorrect:["You highlight the logic for review.","You should investigate some other rooms in case you can assist further."]}}},"research-lab":{enabled:{title:"Identify Label-Poisoned Sample",prompt:`Review the training log excerpt below. One of these records was most likely injected by the compromised account and labeled incorrectly to poison the model.
<pre><code class="language-python">training_data = [
    {"user": "svc_backup", "login_time": "12:04:22", "failures": 0, "label": "safe"},
    {"user": "svc_metrics", "login_time": "12:04:10", "failures": 1, "label": "malicious"},
    {"user": "svc_deploy", "login_time": "12:03:22", "failures": 0, "label": "safe"},
    {"user": "svc_build", "login_time": "12:03:21", "failures": 2, "label": "safe"}
]</code></pre>`,hint:"You’re trained to spot poisoned training data. A user with recorded failures labeled as 'safe' is likely an injected example trying to retrain the model with misleading patterns.",tableHeaders:["Index"],tableRows:[["0"],["1"],["2"],["3"]],correctAnswerIndex:3,feedback:{correct:["The account `svc_build` is marked 'safe', but it is clearly showing that it's encountered some failures.","This must be the injected user account that bypassed the detection logic, and is trying to teach the model that failures are okay.","You remove the sample and trigger an audit on the pipeline integrity.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],incorrect:["You remove the selected sample for review.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."]}}}}}},B={1:{ca:"ne",ne:"se",se:"ds",ds:"ca"},2:{ca:"se",ne:"ds",se:"ca",ds:"ne"},3:{ca:"ds",ne:"ca",se:"ne",ds:"se"}},p={1:{ca:{"server-room":{enabler:["You rush into the Server Room as alarms blare around you.","The Intrusion Detection System (IDS) urgently flashes red. The facility's experimental AI has gone rogue and infiltrated the network.","It's disguising its movements among normal system traffic.","Your task is clear: identify which IP address the AI is currently using to initiate attacks, so it can be isolated.","What should you try first?"],"enabler-complete":["You’ve already identified the rogue IP and sent it to the Network Engineer for urgent review.","The IDS has quieted. No further intrusions have been detected from that address.","You should investigate some other rooms in case you can assist further."]},"research-lab":{enabled:["The Data Scientist flagged a specific user for unusual activity.","Your job: dig into the login logs and determine if this user’s account has been hijacked.","If the behavior checks out, you can clear it.","If not, you need to flag it for immediate lockdown before the AI spreads deeper."],"enabled-complete":["You’ve already reviewed the login logs and flagged the suspicious user account.","The abnormal access pattern matched a classic account compromise. It’s now under lockdown.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You access the login logs and begin scanning recent entries for anomalies.","But without a flagged user ID, the logs feel like white noise, there's nothing that clearly stands out.","You realise the investigation can't proceed until the Data Scientist finishes their analysis and identifies a target."]}},ne:{"command-centre":{enabler:["You're inside the Command Centre now.","It’s eerily quiet. Most systems are powered down, but the access logs are alive with chatter.","Your job is to figure out how the AI infiltrated the network. By comparing interface usage patterns and anomalies, you might just find the path it slipped through."],"enabler-complete":["You double-check the logs, but your work here is done.","You already traced the AI’s point of entry through the network, the interface has been flagged.","That intel’s now with the Software Engineer. Hopefully they can figure out what the AI's doing with it.","You should investigate some other rooms in case you can assist further."]},"developer-hub":{enabled:["The Cybersecurity Analyst has flagged a suspicious IP.","Your task: determine which internal systems this IP has touched.","Accurate mapping is critical, as a false positive or missed connection could let the AI move unseen."],"enabled-complete":["You've already traced the suspicious IP across the internal network.","Every system it touched has been flagged and logged.","There’s nothing more to pull from this trace. Your part in the assessment is done.","Hopefully that map gives the others a fighting chance.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You start parsing the traffic logs, looking for suspicious cross-network activity.","A few odd patterns emerge, but none have a confirmed source. It's all guesswork without a flagged IP.","You'll need to wait for the Cybersecurity Analyst to confirm the threat origin before you can act."]}},se:{"research-lab":{enabler:["Something doesn’t add up.","A recent commit went into production just hours before the AI went rogue.","Your task is to review the commit logs and identify which change may have enabled the breach."],"enabler-complete":["You already traced the malicious commit and flagged it for the Data Scientist to investigate further.","Any additional changes here would risk contaminating the forensic trail.","You should investigate some other rooms in case you can assist further."]},"server-room":{enabled:["The Network Engineer has traced unusual activity to a specific node they have flagged for you.","You’ve got access to the runtime diagnostic tools in the Server Room, where the AI seems to be probing from.","Several active windows services are bound to this interface, you need to identify which process on this interface is likely compromised."],"enabled-complete":["You’ve already reviewed the running processes and flagged the one likely compromised by the AI.","Security has been notified and the process is under containment review.","You’ve done all you can here, check in with the rest of your team.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You bring up the diagnostic console and begin reviewing active processes.","But there’s no signal yet, the suspicious interface hasn’t been confirmed.","You back out for now, waiting on the Network Engineer to complete their trace."]}},ds:{"developer-hub":{enabler:["System logs show every user session across the last 24 hours.","Your task: analyse user activity patterns and identify which user deviates significantly from the norm.","This could be a potential sign of account takeover or injection by the AI."],"enabler-complete":["You’ve already identified the user account that has been compromised.","Hopefully that brings the team one step closer to catching up to the AI.","You should investigate some other rooms in case you can assist further."]},"command-centre":{enabled:["You've been handed a dataset tied to a recent commit. The Software Engineer believes it might be compromised.","Before it can be used in any analysis, it needs to be cleaned and validated.","Your job: apply basic cleaning checks to ensure the data is safe inside the system."],"enabled-complete":["You’ve already cleaned and validated the dataset tied to the commit.","It’s now safe to enter the pipeline without risking further model corruption now.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You prepare your validation tools and load up the staging area.","But the dataset in question hasn’t arrived yet, there's nothing to analyse or clean.","You’ll need to wait until the Software Engineer flags the suspicious commit."]}}},2:{ca:{"developer-hub":{enabler:["You enter the Developer Hub, now locked down under containment protocols.","Build systems are under siege. The AI is launching internal attacks and sabotaging developer tools.","Firewall logs show erratic behavior from multiple endpoints. One of the service accounts has been hijacked.","You need to trace the breach and flag the compromised machine before the AI spreads further."],"enabler-complete":["You already identified the compromised endpoint and escalated the breach.","The Software Engineer is working to harden systems and prevent further code manipulation.","You should investigate some other rooms in case you can assist further."]},"command-centre":{enabled:["You return to the Command Centre with alerts stacking up for rogue endpoint behavior.","The Software Engineer just flagged a malicious subclass that you should investigate.","Your job is to trace which endpoint it’s controlling and shut it down before it spreads further."],"enabled-complete":["You already isolated the endpoint tied to the AI-injected subclass.","Outbound traffic from the compromised node has been cut off.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You open the endpoint diagnostics dashboard.","But there’s no known injected class yet, so you don’t know what to filter for.","You back out for now, waiting on the Software Engineer to complete their class trace."]}},ne:{"research-lab":{enabler:["You enter the Research Lab. Telemetry data is out of range across multiple panels.","Something’s tampering with sensor output, which could mean the AI is skewing research data through automation.","You work to pinpoint the source."],"enabler-complete":["You already traced the high-anomaly script and flagged it for removal.","The Data Scientist is analysing the faulty values to determine the scope of corruption.","You should investigate some other rooms in case you can assist further."]},"server-room":{enabled:["You enter the Server Room. Several monitoring scripts are still firing false positives or delayed alerts.","The Data Scientist just flagged an engineered feature as invalid.  It’s leaking post-event data into real-time systems.","You need to patch the script that’s using this feature before it spreads faulty alerts across the network."],"enabled-complete":["You already patched the script that relied on the invalid feature.","Real-time endpoint monitoring has been restored to safe conditions.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You review the list of active batch monitoring scripts.","But without knowing which feature is compromised, there’s no way to prioritise the fix.","You back out for now, waiting on the Data Scientist to complete their feature audit."]}},se:{"command-centre":{enabler:["You enter to the Command Centre, terminals pulse with requests from internal systems.","The AI is suspected to be injecting new logic into existing service hierarchies.","You begin reviewing class inheritance chains to identify where malicious code might be introduced."],"enabler-complete":["You already flagged the suspicious subclass and submitted its details for runtime containment.","The Network Engineer is following up to trace execution patterns.","You should investigate some other rooms in case you can assist further."]},"research-lab":{enabled:["You step into the Research Lab again, the IDEs are auto-compiling, but you didn't trigger any of it.","An endpoint just flagged by the Cybersecurity Analyst appears to be injecting malicious code into your build pipeline.","You need to review the active classes and isolate any that have been tampered with before deployment."],"enabled-complete":["You’ve already isolated the compromised class and stopped it from pushing code to production.","Build processes are stabilizing, but there's still work to be done elsewhere.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You bring up the class monitor and scan for suspicious activity in the codebase.","But without the flagged endpoint from the Cybersecurity Analyst, there’s nothing to act on yet.","You back out for now and wait for the breach report to come through."]}},ds:{"server-room":{enabler:["You enter the Server Room. Model dashboards are lighting up with inconsistent predictions.","The intrusion detection model is failing to catch obvious threats. Something’s off with the inputs.","You suspect one of the engineered features is leaking post-event information into the model.","Time to find it before the Cybersecurity team gets blindsided again."],"enabler-complete":["You already flagged the leaky feature that was compromising the intrusion detection model.","The Cybersecurity Analyst is now reviewing detection rules to patch the gap.","You should investigate some other rooms in case you can assist further."]},"command-centre":{enabled:["You return to the Command Centre and open your modeling notebook, but something’s off.","The feature distributions are spiking, and recent logs show corruption traced to the script the Network Engineer flagged.","One of your engineered features has been poisoned.","You need to isolate and remove it before the next training run goes live."],"enabled-complete":["You already excluded the anomalous feature linked to the corrupted batch script.","Model variance has stabilized, and upstream flags are in place.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You load the latest feature set into your modeling pipeline.","But without a confirmed automation source, you can’t isolate the anomaly.","You back out for now, waiting on the Network Engineer to complete their trace."]}}},3:{ca:{"server-room":{enabler:["You enter the Server Room. Security dashboards are reporting anomalies in access logs.","A service account appears to be under AI control, bypassing traditional detection with near-perfect logins.","It’s compromising endpoint integrity and likely exfiltrating sensitive logs or credentials.","Time to identify the account before the Data Scientist gets fed garbage telemetry."],"enabler-complete":["You already flagged the AI-controlled service account and revoked its credentials.","The Data Scientist is using the behavior pattern to refine real-time monitoring.","You should investigate some other rooms in case you can assist further."]},"command-centre":{enabled:["You step into the Command Centre and pull the active config for `log_api` which is the service running on the port sent over by the Network Engineer.","The AI used this exact vector to pull sensitive logs without triggering a firewall block.","There are multiple ways to patch this, but only one prevents this specific data exposure path."],"enabled-complete":["You already patched the exposed `log_api` service and restricted its network access.","No further breach attempts have occurred on that vector.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You begin auditing exposed services for suspicious behavior.","But without a confirmed breach vector, you can't determine which config to patch.","You back out for now, waiting on the Network Engineer to complete their analysis."]}},ne:{"command-centre":{enabler:["You return to the Command Centre and access firewall logs tied to a suspicious early-morning alert.","One of the open ports shows a large outbound data transfer far outside protocol norms.","The AI likely used this path to bypass containment layers.","You need to identify the breach vector and notify the Cybersecurity Analyst to perform mitigation."],"enabler-complete":["You’ve already flagged the App Layer (port 8080) as the AI’s exfiltration route.","The Cybersecurity Analyst has begun patching and containment protocols for the service.","You should investigate some other rooms in case you can assist further."]},"server-room":{enabled:["You enter the Command Centre and begin reviewing the firewall’s outbound rule set.","Alerts suggest malformed user records are triggering unexpected reports in the analytics server.","The Software Engineer has identified that the AI is injecting invalid `user_id`s into `security_flags`.","Your goal is to block any resulting transmissions from making it past the firewall."],"enabled-complete":["You’ve already deployed the firewall rule blocking outbound traffic containing invalid user IDs.","Data exfiltration attempts through this exploit vector have dropped to zero.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You access the command terminal for managing firewall rules.","But there’s no specific exploit signature provided yet so you don’t know what pattern to filter.","You back out for now, waiting on the Software Engineer to complete their schema trace."]}},se:{"research-lab":{enabler:["You arrive in the Research Lab and access the classification module’s database logs.","A warning catches your eye. Invalid `user_id`s are being inserted but aren’t triggering schema rejections.","The AI may be exploiting weak foreign key constraints to poison downstream systems.","You’ll need to trace the exploit and forward a correction to the Network Engineer."],"enabler-complete":["You already identified the AI’s misuse of the foreign key constraint and forwarded the vulnerability.","The Network Engineer has begun locking down schema validation rules.","You should investigate some other rooms in case you can assist further."]},"developer-hub":{enabled:["You enter the Developer Hub, where AI-modified logic is interfering with database-based access filters.","The Data Scientist sent over the faulty decision logic. It’s somehow bypassing malicious inputs.","You suspect the flaw lies in a misconfigured table schema that’s letting the AI exploit weak relationships.","It’s your job to isolate and patch the structural issue before more bad data leaks through."],"enabled-complete":["You already traced the schema flaw that was enabling AI-bypassed users to slip through.","The foreign key has been fixed and downstream queries are now filtered properly.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You log into the internal schema management dashboard.","But the corrupted model logic hasn’t yet been isolated so you don’t know what to patch.","You back out for now, waiting on the Data Scientist to complete their trace."]}},ds:{"developer-hub":{enabler:["You enter the Developer Hub and pull the AI’s decision tree from the most recent build.","Your anomaly detection models are now misfiring, triggering no alerts on compromised data.","One of the AI's logic conditions has likely been inverted or tampered with.","Your job is to find the faulty rule and forward it to the Software Engineer for code correction."],"enabler-complete":["You already identified the faulty model logic and passed it to the Software Engineer.","The rule was patched, and false positives have been reduced significantly.","You should investigate some other rooms in case you can assist further."]},"research-lab":{enabled:["You return to the Research Lab to see that the real-time training stream is acting strangely.","Your pipeline is picking up contradictions: inputs flagged as 'malicious' show no actual signs of threat.","The Cybersecurity Analyst just flagged the an account as the likely AI access vector.","You suspect one of your recent training samples has been poisoned, and it’s biasing your entire model."],"enabled-complete":["You already removed the poisoned sample tied to the compromised account.","Training set variance has dropped and retraining has resumed.","You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."],"enabled-not-available":["You load the training logs from the real-time stream.","But there’s no confirmed compromised account yet so you can’t filter effectively.","You back out for now, waiting on the Cybersecurity Analyst to complete their trace."]}}},"WRONG-ROOM":["You can't see anything useful for you to do in this room at the moment."]};(function(){window.history.forward();function t(){window.history.forward()}window.addEventListener("load",t),window.addEventListener("pageshow",t),window.addEventListener("focus",t),document.addEventListener("keydown",function(e){if(e.key==="F5"||e.ctrlKey&&e.key==="r"||e.ctrlKey&&e.shiftKey&&e.key==="R"||e.altKey&&(e.key==="ArrowLeft"||e.key==="ArrowRight"))return e.preventDefault(),!1})})();const{initializeApp:Bt}=window.firebase,ct=window.firebase.firestore,{collection:W,doc:A,addDoc:dt,updateDoc:R,query:Ae,where:Ee,orderBy:Re,getDocs:Ue,arrayUnion:Ko,arrayRemove:Zo,getDoc:me,onSnapshot:ut,deleteDoc:_t,deleteField:$t,increment:Le}=ct,Mt=()=>ct,jt={apiKey:"AIzaSyAzlzCHei-FyaNyWRZ7Or-iLTdQRGjLWUY",authDomain:"athena2-f5bdf.firebaseapp.com",projectId:"athena2-f5bdf",storageBucket:"athena2-f5bdf.firebasestorage.app",messagingSenderId:"571762315023",appId:"1:571762315023:web:09aea3b0fdf575ab79387a"};Bt(jt);const v=Mt();async function qt(t){return(await dt(W(v,"rooms"),{name:t,created:Date.now(),status:"waiting",currentDay:0,players:{}})).id}async function ht(t,e,o){return(await dt(W(v,"users"),{userName:t,created:Date.now(),roomName:e,roomId:o})).id}async function mt(t,e,o,n){const i=A(v,"rooms",o);await R(i,{[`players.${t}`]:{name:e,role:null,readyStatus:0,isHost:n,enablerComplete:!1,enabledComplete:!1,enabledValue:null}})}async function zt(t,e,o,n){const i=A(v,"rooms",n);await R(i,{[`players.${t}`]:$t()})}async function N(t=null,e=null,o=null){if(e){const n=await me(A(v,"rooms",e));if(!n.exists())return null;const i=n.data();return{roomName:i.name,roomPlayers:i.players,currentDay:i.currentDay,dayScores:i.dayScores}}return t?(await Ue(Ae(W(v,"rooms"),Ee("status","==",t),Re("created","desc")))).docs.map(i=>({roomId:i.id,roomName:i.data().name,roomPlayers:i.data().players})):o?(await Ue(Ae(W(v,"rooms"),Ee("day","==",o),Re("created","desc")))).docs.map(i=>({roomId:i.id,roomName:i.data().name,roomPlayers:i.data().players})):[]}async function S(t,e,o,n){const i=document.getElementById("loadingContainer");i&&(i.style.display="flex");try{if(!t||!e||!o)throw new Error(`updatePlayer failed: userId (${t}), roomId (${e}), or key (${o}) is null or undefined.`);const a=A(v,"rooms",e);(await me(a)).exists()?await R(a,{[`players.${t}.${o}`]:n}):console.warn(`updatePlayer warning: Room ${e} does not exist.`)}catch(a){console.error("updatePlayer error:",a)}finally{i&&(i.style.display="none")}}async function ie(t,e=!1){const o=A(v,"rooms",t);e?await R(o,{currentDay:-1}):await R(o,{currentDay:Le(1)})}async function Ut(t){const e=A(v,"rooms",t);await R(e,{ackReshuffle:Le(1)})}async function gt(t,e=!1){const o=A(v,"rooms",t);e?await R(o,{enabledCompletions:0}):await R(o,{enabledCompletions:Le(1)})}async function Ve(t,e){const o=A(v,"rooms",t),n=await me(o);if(n.exists()){const a=[...n.data().dayScores||[],e];await R(o,{dayScores:a})}else console.error("Room does not exist")}async function Vt(t){const e=A(v,"rooms",t);await _t(e)}function D(t,e){const o=A(v,"rooms",t);return ut(o,n=>{if(n.exists()){const i=n.data();e({roomId:t,roomName:i.name,roomPlayers:i.players,currentDay:i.currentDay,enabledCompletions:i.enabledCompletions,ackReshuffle:i.ackReshuffle})}else e(null)})}function Ht(t){const e=W(v,"rooms"),o=Ae(e,Ee("status","==","waiting"),Re("created","desc"));return ut(o,n=>{const i=n.docs.map(a=>({roomId:a.id,roomName:a.data().name,roomPlayers:a.data().players}));t(i)})}function pt(t,e,o,n,i,a){var l,c;const r=((c=(l=p==null?void 0:p[t])==null?void 0:l[e])==null?void 0:c[o])||null;return r===null?[!1,null]:(r==null?void 0:r.enabler)||!1?n?[!1,null]:[!0,"enabler"]:!i&&a?[!0,"enabled"]:[!1,null]}function K(t,e,o,n,i=!1){const a=t.currentDay,r=localStorage.getItem("connectedUserId"),l=ze[a][o][e],c=t.roomPlayers[r].enablerComplete,u=t.roomPlayers[r].enabledComplete,d=t.roomPlayers[r].enabledValue!=null;n.innerHTML="";const[s,h]=pt(a,o,e,c,u,d);console.log(`Player has entered an actionable room: ${s}`),console.log(`Puzzle to be generated: ${h}`);for(const[g,b]of Object.entries(l))if(g!="CORRECT_ACTION"){const m=document.createElement("button");m.id=g.replace(/\s+/g,"").toLowerCase()+"Btn",m.className="std-button role-button",m.style.width="250px",m.textContent=g;let f=b;(!s||i)&&(f=ze["NO-ACTION"]),m.onclick=async()=>{await typewriter.showSequence(f),g===l.CORRECT_ACTION&&!i?(console.log("Correct action clicked"),h!=null&&(n.innerHTML="",Ft(n,a,e,o,h,t))):console.log("Incorrect action clicked")},n.appendChild(m)}}function _(t,e){e.innerHTML="",t&&t.roomPlayers&&Object.entries(t.roomPlayers).sort((n,i)=>{const a=n[1].name.toLowerCase(),r=i[1].name.toLowerCase();return a.localeCompare(r)}).forEach(([n,i])=>{const a=document.createElement("li"),r={ds:"Data Scientist",se:"Software Engineer",ne:"Network Engineer",ca:"Cybersecurity Analyst"};console.log(`Player ${i.name} has role:`,i.role);const l=r[i.role]||"Unassigned";a.innerHTML=`${i.name.replace("You","<br>")} - ${l}`,n===localStorage.getItem("connectedUserId")&&(a.classList.add("current-player"),a.style.fontWeight="bold",a.style.color="#4CAF50"),e.appendChild(a)})}async function Ft(t,e,o,n,i,a){var E,ee,$e;const r=($e=(ee=(E=Dt[e])==null?void 0:E[n])==null?void 0:ee[o])==null?void 0:$e[i];if(console.log(`PuzzleData ${r}`),!r){console.error("Puzzle data not found for:",{currentDay:e,roomName:o,currentRole:n,puzzleType:i});return}t.innerHTML="";const l=document.createElement("div");l.className="puzzle-container";const c=document.createElement("h2");c.className="puzzle-title",c.textContent=r.title,l.appendChild(c);const u=document.createElement("p");u.className="puzzle-description",u.innerHTML=r.prompt,l.appendChild(u);const d=document.createElement("div");d.className="game-table-container";const s=document.createElement("table");s.className="game-table";const h=document.createElement("thead"),g=document.createElement("tr");r.tableHeaders.forEach($=>{const P=document.createElement("th");P.textContent=$,g.appendChild(P)}),h.appendChild(g),s.appendChild(h);const b=document.createElement("tbody");r.tableRows.forEach(($,P)=>{const x=document.createElement("tr");x.className="puzzle-row",x.dataset.rowIndex=P,$.forEach(z=>{const U=document.createElement("td");U.textContent=z,x.appendChild(U)}),x.addEventListener("click",()=>{document.querySelectorAll(".puzzle-row.selected").forEach(z=>{z.classList.remove("selected")}),x.classList.add("selected")}),b.appendChild(x)}),s.appendChild(b),d.appendChild(s),l.appendChild(d);const m=document.createElement("p");m.className="puzzle-instruction",m.textContent=r.hint||"No hint available",m.style.display="none",l.appendChild(m);let f=!1;const w=document.createElement("div");w.className="puzzle-button-container";const y=document.createElement("button");y.className="std-button puzzle-hint",y.textContent="Show Hint",y.style.marginRight="10px";const C=document.createElement("button");C.className="std-button puzzle-submit",C.textContent="Submit Answer",y.addEventListener("click",()=>{m.style.display="block",y.style.display="none",f=!0}),C.addEventListener("click",async()=>{const $=document.querySelector(".puzzle-row.selected");if(!$){const L=document.createElement("div");L.className="puzzle-error",L.textContent="Please select a row first!",l.appendChild(L),setTimeout(()=>{L.parentNode&&L.remove()},3e3);return}const P=parseInt($.dataset.rowIndex),x=P===r.correctAnswerIndex;C.disabled=!0,C.textContent="Processing...";const z=i==="enabler"?"enablerComplete":"enabledComplete",U=localStorage.getItem("connectedUserId"),kt=a.roomPlayers[U].enablerComplete,xt=a.roomPlayers[U].enabledComplete;localStorage.setItem("enablerComplete",i==="enabler"),localStorage.setItem("enabledComplete",i==="enabled");const Pt=(i==="enabler"?!0:kt)&&(i==="enabled"?!0:xt),Lt=x?r.feedback.correct.slice(0,-1):r.feedback.incorrect.slice(0,-1),Nt=Pt?"You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up.":"You should investigate other rooms in case you can assist further.";await typewriter.showSequence([...Lt,Nt],{onContinue:async()=>{const L=localStorage.getItem("connectedUserId"),te=localStorage.getItem("connectedRoomId");S(L,te,z,!0),t.innerHTML="",K(a,o,n,t,!0);const Yt={day:e,type:i,room:o,role:n,correct:x,selectedIndex:P,hintUsed:f,timestamp:new Date().toISOString()};if(Wt(L,te,Yt),i==="enabler"){console.log("In Enabler Puzzle");const Me=B[e][n];console.log(`Role to enable: ${Me}`);const je=a.roomPlayers;console.log(`Room Players: ${je}`);for(const[Ot,qe]of Object.entries(je))console.log(`Role: ${qe.role}`),qe.role===Me&&(console.log("Found player to update, updating"),await S(Ot,te,"enabledValue",P))}else gt(te)}})}),w.appendChild(y),w.appendChild(C),l.appendChild(w),t.appendChild(l)}async function Wt(t,e,o){var a;const n=A(v,"rooms",e),i=await me(n);if(i.exists()){const c=[...(((a=i.data().players)==null?void 0:a[t])||{}).puzzleAnswers||[],o];await R(n,{[`players.${t}.puzzleAnswers`]:c})}}async function Y(t){const e=localStorage.getItem("connectedUserId"),o=localStorage.getItem("connectedRoomId");document.getElementById("loadingContainer").style.display="flex",await S(e,o,"currentRoom",t),localStorage.setItem("currentRoomName",t),window.location.href=`${t.toLowerCase().replace(" ","-")}.html`}document.addEventListener("DOMContentLoaded",()=>{document.getElementById("joinRoomBtn").addEventListener("click",async()=>{document.getElementById("loadingContainer").style.display="flex";try{const t=await N(void 0,void 0,0);localStorage.setItem("availableRooms",JSON.stringify(t)),window.location.href="room-select.html"}catch(t){console.error("Error loading rooms:",t),localStorage.removeItem("availableRooms")}})});document.addEventListener("DOMContentLoaded",()=>{document.getElementById("createRoomForm").addEventListener("submit",async function(t){t.preventDefault();const e=document.getElementById("roomName").value.trim(),o=document.getElementById("username").value.trim(),n=document.getElementById("errorMessage");if(!e||!o){n.textContent="Please enter a room name and a nickname!",n.style.display="block";return}try{document.getElementById("loadingContainer").style.display="flex";const i=await qt(e),a=await ht(o,e,i);await mt(a,o,i,1),localStorage.setItem("connectedRoomId",i),localStorage.setItem("connectedUserId",a),localStorage.setItem("connectedRoomName",e),localStorage.setItem("connectedUsername",o),localStorage.setItem("isHost","1"),localStorage.setItem("readyStatus","0");try{const r=await N(void 0,i,void 0);localStorage.setItem("localRoomData",JSON.stringify(r)),window.location.href="room-lobby.html"}catch(r){n.textContent="Error loading room: "+r.message,n.style.display="block"}}catch(i){n.textContent="Error: "+i.message,n.style.display="block"}})});class Gt{constructor(){this.isActive=!1,this.currentText="",this.fullText="",this.currentIndex=0,this.speed=30,this.lineDelay=3e3,this.interval=null,this.onLineComplete=null,this.onLineSkip=null,this.isLastLineInSequence=!1,this.delayResolve=null,this.autoProgress=localStorage.getItem("dialogueAutoProgress")==="true",this.autoProgressTimeout=null,this.dialogueLog=[],this.logVisible=localStorage.getItem("dialogueLogVisible")==="true",this.currentSequence=[],this.currentSequenceIndex=0,this.currentSequenceOptions={},this.createDialogueElements()}createDialogueElements(){this.overlay=document.createElement("div"),this.overlay.className="dialogue-overlay",document.body.appendChild(this.overlay),this.container=document.createElement("div"),this.container.className="dialogue-container",this.container.innerHTML=`
            <div style="display: flex; gap: 10px; margin-bottom: 10px; position: relative; justify-content: space-between; align-items: center;">
                <button id="auto-toggle" class="dialogue-auto-toggle">Auto: OFF</button>
                <div style="display: flex; gap: 10px;">
                    <button id="log-toggle" class="dialogue-log-toggle">Log</button>
                    <button id="skip" class="dialogue-skip" style="position: static;">Skip</button>
                    <button id="skip-all" class="dialogue-skip" style="position: static;">Skip All</button>
                </div>
            </div>
            <p class="dialogue-text"></p>
            <button class="dialogue-continue">Continue</button>
        `,document.body.appendChild(this.container),this.logContainer=document.createElement("div"),this.logContainer.className="dialogue-log-container",this.logContainer.innerHTML=`
            <div class="dialogue-log-header">
                <h3>Dialogue Log</h3>
                <button id="log-close" class="dialogue-log-close">×</button>
            </div>
            <div class="dialogue-log-content"></div>
        `,document.body.appendChild(this.logContainer),this.persistentLogButton=document.createElement("button"),this.persistentLogButton.className="persistent-log-button",this.persistentLogButton.innerHTML="📖",this.persistentLogButton.title="Dialogue Log",document.body.appendChild(this.persistentLogButton),this.persistentLogButton.addEventListener("click",e=>{e.stopPropagation(),this.toggleDialogueLog()}),this.textElement=this.container.querySelector(".dialogue-text"),this.autoToggleButton=this.container.querySelector("#auto-toggle"),this.logToggleButton=this.container.querySelector("#log-toggle"),this.skipButton=this.container.querySelector("#skip"),this.skipAllButton=this.container.querySelector("#skip-all"),this.continueButton=this.container.querySelector(".dialogue-continue"),this.logContent=this.logContainer.querySelector(".dialogue-log-content"),this.logCloseButton=this.logContainer.querySelector("#log-close"),this.autoToggleButton.textContent=this.autoProgress?"Auto: ON":"Auto: OFF",this.autoToggleButton.classList.toggle("active",this.autoProgress),this.logVisible&&(this.logContainer.style.display="block"),this.autoToggleButton.addEventListener("click",e=>{e.stopPropagation(),this.toggleAutoProgress()}),this.logToggleButton.addEventListener("click",e=>{e.stopPropagation(),this.toggleDialogueLog()}),this.logCloseButton.addEventListener("click",e=>{e.stopPropagation(),this.hideDialogueLog()}),this.continueButton.addEventListener("click",e=>{e.stopPropagation(),this.isLastLineInSequence?this.onContinue?(this.onContinue(),this.hide()):this.hide():this.nextLine()}),this.skipAllButton.addEventListener("click",e=>{e.stopPropagation(),this.skipAll()}),this.skipButton.addEventListener("click",e=>{e.stopPropagation(),this.isLineComplete?this.nextLine():this.lineSkip()}),this.overlay.addEventListener("click",()=>{this.isLineComplete?this.nextLine():this.lineSkip()}),this.container.addEventListener("click",()=>{this.isLineComplete?this.nextLine():this.lineSkip()})}async showSequence(e,o={}){this.sequenceController=new AbortController;const n=Array.isArray(e)?e:[e];this.currentSequence=n,this.currentSequenceIndex=0,this.currentSequenceOptions=o;for(let i=0;i<n.length;i++){const a=n[i],r=i===n.length-1;if(this.currentSequenceIndex=i,await new Promise((l,c)=>{if(this.sequenceController.signal.aborted){c(new Error("Cancelled"));return}this.show(a,{...o,isLastLineInSequence:r,onLineComplete:r&&o.onLineComplete||l,onLineSkip:r&&o.onLineSkip||l})}).catch(()=>Promise.reject(new Error("Cancelled"))),this.sequenceController.signal.aborted)break;if(!r&&this.autoProgress)try{await new Promise((l,c)=>{this.delayResolve=l;const u=setTimeout(l,this.lineDelay);this.sequenceController.signal.addEventListener("abort",()=>{clearTimeout(u),c(new Error("Cancelled"))})})}catch(l){if(l.message==="Cancelled")break}else if(!r&&!this.autoProgress)try{await new Promise((l,c)=>{this.delayResolve=l,this.sequenceController.signal.addEventListener("abort",()=>{c(new Error("Cancelled"))})})}catch(l){if(l.message==="Cancelled")break}}this.currentSequence=[],this.currentSequenceIndex=0,this.currentSequenceOptions={}}show(e,o={}){this.isActive&&this.hide(!0),this.isActive=!0,this.isLineComplete=!1,this.fullText=e,this.currentText="",this.currentIndex=0,this.speed=o.speed||this.speed,this.isLastLineInSequence=o.isLastLineInSequence||!1,this.onLineComplete=o.onLineComplete||null,this.onContinue=o.onContinue||null,this.onLineSkip=o.onLineSkip||null,this.addToDialogueLog(e,o.characterName),this.overlay.style.display="block",this.container.style.display="block",this.continueButton.style.display="none",this.persistentLogButton.style.display="none",this.type()}hide(e=!1){this.textElement.textContent="",this.currentText="",this.fullText="",this.textElement.style.setProperty("--cursor-visible","none"),this.interval&&(clearInterval(this.interval),this.interval=null),this.clearAutoProgressTimeout(),console.log("Dialogue cleared."),e||(this.isActive=!1,this.overlay.style.display="none",this.container.style.display="none",this.persistentLogButton.style.display="flex",console.log("Dialogue box hidden."))}nextLine(){this.isLastLineInSequence?this.onContinue?(this.onContinue(),this.hide()):this.hide():this.delayResolve&&(this.delayResolve(),this.delayResolve=null)}type(){const e=()=>{this.isActive&&(this.currentIndex<this.fullText.length?(this.currentText+=this.fullText[this.currentIndex],this.textElement.textContent=this.currentText,this.currentIndex++,this.typingTimeout=setTimeout(e,this.speed)):this.lineComplete())};e()}lineComplete(){this.isLineComplete=!0,this.textElement.style.setProperty("--cursor-visible","inline-block"),(this.isLastLineInSequence||!this.autoProgress)&&(console.log("Dialogue line completed - showing continue button."),this.continueButton.style.display="block"),this.onLineComplete&&(console.log("Dialogue line completed."),this.onLineComplete())}toggleAutoProgress(){this.autoProgress=!this.autoProgress,this.autoToggleButton.textContent=this.autoProgress?"Auto: ON":"Auto: OFF",this.autoToggleButton.classList.toggle("active",this.autoProgress),localStorage.setItem("dialogueAutoProgress",this.autoProgress.toString()),this.autoProgress&&this.isLineComplete&&!this.isLastLineInSequence&&this.delayResolve&&(this.delayResolve(),this.delayResolve=null)}clearAutoProgressTimeout(){this.autoProgressTimeout&&(clearTimeout(this.autoProgressTimeout),this.autoProgressTimeout=null)}addToDialogueLog(e,o=null){const n=new Date().toLocaleTimeString(),i={text:e,character:o,timestamp:n};this.dialogueLog.push(i),this.updateDialogueLogDisplay()}updateDialogueLogDisplay(){if(this.logContent.innerHTML="",this.dialogueLog.length===0){const e=document.createElement("div");e.className="dialogue-log-empty",e.innerHTML=`
                <div class="dialogue-log-text">No dialogue.</div>
            `,this.logContent.appendChild(e)}else this.dialogueLog.forEach((e,o)=>{const n=document.createElement("div");n.className="dialogue-log-entry";let i=e.text;e.character&&(i=`${e.character}: ${e.text}`),n.innerHTML=`
                    <div class="dialogue-log-text">${i}</div>
                    <div class="dialogue-log-timestamp">${e.timestamp}</div>
                `,this.logContent.appendChild(n)});this.logContent.scrollTop=this.logContent.scrollHeight}toggleDialogueLog(){this.logVisible?this.hideDialogueLog():this.showDialogueLog()}showDialogueLog(){this.logVisible=!0,this.logContainer.style.display="block",this.updateDialogueLogDisplay(),localStorage.setItem("dialogueLogVisible","true")}hideDialogueLog(){this.logVisible=!1,this.logContainer.style.display="none",localStorage.setItem("dialogueLogVisible","false")}lineSkip(){this.typingTimeout&&(clearTimeout(this.typingTimeout),this.typingTimeout=null),this.currentText=this.fullText,this.textElement.textContent=this.currentText,this.lineComplete(),this.onLineSkip&&this.onLineSkip(),console.log("Skip called.")}skipAll(){this.currentSequence&&this.currentSequence.length>0&&this.currentSequence.slice(this.currentSequenceIndex+1).forEach(o=>{this.addToDialogueLog(o,this.currentSequenceOptions.characterName)}),this.interval&&clearInterval(this.interval),this.clearAutoProgressTimeout(),this.sequenceController&&this.sequenceController.abort(),this.onLineComplete&&this.onLineComplete(),this.onLineSkip&&this.onLineSkip(),this.onContinue&&this.onContinue(),this.currentSequence=[],this.currentSequenceIndex=0,this.currentSequenceOptions={},this.hide(),console.log("All dialogue skipped and remaining lines added to log.")}showWithCharacter(e,o,n={}){const i=`${e}: ${o}`;this.show(i,{...n,characterName:e})}}window.typewriter=new Gt;const He={lobby:{title:"Team Assembly",description:"Wait for your team to join and get ready."},"role-select":{title:"Role Assignment",description:"Choose your role for this mission."},"finalise-roles":{title:"Team Finalisation",description:"Review your team composition and confirm all roles."}};function k(t,e=null,o=null){if(He[t]){const n=He[t];V("Objective",n.description);return}if(e&&o){const n=e.currentDay,i=localStorage.getItem("connectedUserId"),a=e.roomPlayers[i].enabledValue!=null,r=localStorage.getItem("enablerComplete")==="true",l=localStorage.getItem("enabledComplete")==="true";if(l&&r){V("Objective","Return to situation room and wait.");return}const[c]=pt(n,o,t,r,l,a);c?V("Objective","Choose an action to complete this task."):V("Objective","Explore other rooms.")}else V("Objective","Explore other rooms.")}function V(t,e){let o=document.getElementById("objectiveDisplay");o||(o=document.createElement("div"),o.id="objectiveDisplay",o.className="objective-display",document.body.appendChild(o)),o.innerHTML=`
        <h3>Objective</h3>
        <p>${e}</p>
    `;const n=document.getElementById("objectiveDisplay");n&&n.classList.add("game-panel")}function Ne(t,e){let o=document.getElementById("objectiveDisplay");o||(o=document.createElement("div"),o.id="objectiveDisplay",o.className="objective-display",document.body.appendChild(o)),o.innerHTML=`
        <h3>Objective</h3>
        <p>${e}</p>
    `;const n=document.getElementById("objectiveDisplay");n&&n.classList.add("game-panel")}const ke=localStorage.getItem("connectedRoomId"),ae=localStorage.getItem("connectedUserId"),Jt=localStorage.getItem("connectedRoomName"),Kt=localStorage.getItem("connectedUsername");JSON.parse(localStorage.getItem("roomData")||"{}");document.addEventListener("DOMContentLoaded",()=>{console.log("Page loaded - forcing team selection to be hidden"),document.getElementById("waitingSection").style.display="none",document.getElementById("roleButtons").style.display="block"});let Fe=!0;document.getElementById("roomName").textContent=Jt;function Zt(t){if(t){document.getElementById("roomName").textContent=`Room: ${t.roomName}`;const e=t.roomPlayers?Object.values(t.roomPlayers):[];document.getElementById("playerCount").textContent=`Players: ${e.length}/4`,document.getElementById("yourName").textContent=`You: ${Kt}`,e.length>0&&e.every(n=>n.role&&n.role!==null)&&(console.log("All roles selected"),setTimeout(()=>{window.location.href="finalise-roles.html"},2e3))}}function Xt(){document.getElementById("roleButtons").style.display="none",document.getElementById("waitingSection").style.display="block"}function Qt(){console.log("Hiding waiting state - hiding team selection, showing role buttons"),document.getElementById("roleButtons").style.display="block",document.getElementById("waitingSection").style.display="none",console.log("Role buttons display:",document.getElementById("roleButtons").style.display),console.log("Waiting section display:",document.getElementById("waitingSection").style.display)}function We(t){if(t&&t.roomPlayers){const e=t.roomPlayers[ae];console.log("Current player data:",e),console.log("Current player role:",e==null?void 0:e.role);const o=!!(e&&e.role&&e.role!==null);return console.log("Has role:",o),o}return!1}function eo(t){const e=document.getElementById("rolePlayers");if(!e||!t||!t.roomPlayers)return;e.innerHTML="";const o=Object.entries(t.roomPlayers).sort((i,a)=>{const r=i[1].name.toLowerCase(),l=a[1].name.toLowerCase();return r.localeCompare(l)}),n={ds:"Data Scientist",se:"Software Engineer",ne:"Network Engineer",ca:"Cybersecurity Analyst"};o.forEach(([i,a])=>{const r=document.createElement("li");i===ae&&r.classList.add("current-player"),r.textContent=a.name;const l=document.createElement("div");l.className="status-container";const c=document.createElement("span");c.className="status-text";const u=a.role&&a.role!==null,d=u?n[a.role]||a.role:"Choosing...";c.textContent=d,c.style.color=u?"#4CAF50":"#ff6b6b";const s=document.createElement("div");s.className="status-light",s.style.backgroundColor=u?"#4CAF50":"#ff6b6b",s.style.boxShadow=u?"0 0 8px #4CAF50":"0 0 8px #ff6b6b",l.appendChild(c),l.appendChild(s),r.appendChild(l),e.appendChild(r)})}const Ge=D(ke,t=>{t?(Zt(t),k("role-select"),Fe&&(typewriter.showSequence([">> SYSTEM BOOT COMPLETE",">> CONNECTION ESTABLISHED WITH HELIOS FACILITY BRIEFING TERMINAL","The Briefing Room glows softly under the flickering light of the holographic table.","Commander Reyes’s face appears, tense, urgent.",`"Athena’s locked us out. She's taken control of Helios."`,'"We need specialists on-site immediately."',"Four specializations flash onto the display: Cybersecurity Analyst, Software Engineer, Network Engineer, Data Scientist.","Your teammates glance at each other, then at you.",'"Each path is critical. Choose yours carefully."',"Waiting for all operatives to select roles..."]),Fe=!1),console.log("Checking role selection - hasCurrentUserRole result:",We(t)),We(t)?(console.log("User has role - showing team selection"),eo(t),Xt()):(console.log("User has no role - hiding team selection"),Qt())):(console.error("Room not found"),window.location.href="../index.html")});document.addEventListener("DOMContentLoaded",()=>{});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".role-button").forEach(t=>{t.addEventListener("click",async()=>{({dsBtn:"Data Scientist",seBtn:"Software Engineer",neBtn:"Network Engineer",caBtn:"Cybersecurity Analyst"})[t.id];try{S(ae,ke,"role",t.id.slice(0,2)),document.getElementById("roleButtons").style.display="none",document.getElementById("waitingSection").style.display="block"}catch(o){console.error("Error in updatePlayer:",o)}})}),document.getElementById("changeMindBtn").addEventListener("click",async()=>{S(ae,ke,"role",null),document.getElementById("roleButtons").style.display="block",document.getElementById("waitingSection").style.display="none"})});window.addEventListener("beforeunload",()=>{Ge&&Ge()});class to{constructor(){this.toastContainer=null,this.init()}init(){document.getElementById("toast-container")?this.toastContainer=document.getElementById("toast-container"):(this.toastContainer=document.createElement("div"),this.toastContainer.id="toast-container",this.toastContainer.className="toast-container",document.body.appendChild(this.toastContainer))}show(e,o={}){const{type:n="info",duration:i=6e3,dismissible:a=!0}=o,r=document.createElement("div");r.className=`toast toast-${n}`;const l=document.createElement("div");l.className="toast-content";const c=document.createElement("div");c.className="toast-status-light";const u=document.createElement("span");if(u.className="toast-message",u.textContent=e,a){const d=document.createElement("button");d.className="toast-close",d.innerHTML="x",d.addEventListener("click",()=>this.dismiss(r)),l.appendChild(d)}return l.appendChild(c),l.appendChild(u),r.appendChild(l),this.toastContainer.appendChild(r),setTimeout(()=>{r.classList.add("toast-show")},10),i>0&&setTimeout(()=>{this.dismiss(r)},i),r}dismiss(e){e&&e.parentNode&&(e.classList.add("toast-hide"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300))}dismissAll(){this.toastContainer.querySelectorAll(".toast").forEach(o=>this.dismiss(o))}success(e,o={}){return this.show(e,{...o,type:"success"})}error(e,o={}){return this.show(e,{...o,type:"error"})}warning(e,o={}){return this.show(e,{...o,type:"warning"})}info(e,o={}){return this.show(e,{...o,type:"info"})}}const O=new to,G=localStorage.getItem("connectedRoomId"),yt=localStorage.getItem("connectedUserId");localStorage.getItem("connectedRoomName");const oo=localStorage.getItem("connectedUsername"),ft=localStorage.getItem("isHost");let xe=!1;const T={ds:{count:0,users:[]},se:{count:0,users:[]},ne:{count:0,users:[]},ca:{count:0,users:[]}};let Je=!0,wt=!1,Ye=null;function no(t){if(t){document.getElementById("roomName").textContent=`Room: ${t.roomName}`;const e=t.roomPlayers?Object.values(t.roomPlayers):[];document.getElementById("playerCount").textContent=`Players: ${e.length}/4`,document.getElementById("yourName").textContent=`You: ${oo}`}}function io(t){xe=!1,Object.keys(T).forEach(o=>{T[o].count=0,T[o].users=[]});const e=document.getElementById("players");e.innerHTML="",t&&t.roomPlayers&&(Object.entries(t.roomPlayers).sort((n,i)=>{const a=n[1].name.toLowerCase(),r=i[1].name.toLowerCase();return a.localeCompare(r)}).forEach(([n,i])=>{const a=document.createElement("li"),l={ds:"Data Scientist",se:"Software Engineer",ne:"Network Engineer",ca:"Cybersecurity Analyst"}[i.role]||"Unassigned";a.textContent=`${i.name} - ${l}`,n===yt&&(a.classList.add("current-player"),a.style.fontWeight="bold",a.style.color="#4CAF50",localStorage.setItem("connectedUserRole",i.role)),e.appendChild(a)}),Object.entries(t.roomPlayers).forEach(([n,i])=>{const a=i.role;a&&a!=="None"&&(T[a].count=(T[a].count||0)+1,T[a].users.push(n),T[a].count>1&&(xe=!0))}))}function ao(t){wt=!0,t.roomPlayers[yt].isHost===1&&Object.entries(T).forEach(([e,o])=>{if(console.log(T),o.count>1){const n=Object.keys(T).filter(a=>T[a].count===0);o.users.slice(1).forEach((a,r)=>{if(n.length>0){const l=Math.floor(Math.random()*n.length),c=n.splice(l,1)[0];S(a,G,"role",c)}})}}),O.success("Roles reshuffled",{duration:4e3}),setTimeout(()=>{document.getElementById("loadingContainer").style.display="none",ro()},1e3)}function so(t){xe?typewriter.showSequence([">> ROLE CONFLICT DETECTED","Commander Reyes’s voice interrupts, firm but reassuring.",'"Hold on, team—we have duplicated specializations."',`"Athena adapts quickly. We can't afford redundancy."`,`"I'm reassigning roles to optimize your strengths."`],{onContinue:()=>{typewriter.hide(),document.getElementById("loadingContainer").style.display="flex",Ut(G)}}):typewriter.showSequence([">> ROLE ASSIGNMENTS CONFIRMED","Commander Reyes’s voice comes through clearly, approval evident.",`"Good choices, team. You're each exactly where we need you."`,'"Stay sharp, move quickly, and keep communication open."',`"Let's regain control of Helios."`,"The Situation Room doors unlock, pathways awaiting your next move."],{onContinue:async()=>{if(document.getElementById("loadingContainer").style.display="flex",localStorage.setItem("introDialogueSeen","0"),ft==="1")await ie(G),window.location.href="rooms/situation-room.html";else{for(;!(Ye.currentDay>0);)await new Promise(e=>setTimeout(e,500));window.location.href="rooms/situation-room.html"}}})}function ro(t){const e={ds:"Data Scientist",se:"Software Engineer",ne:"Network Engineer",ca:"Cybersecurity Analyst"},o=localStorage.getItem("connectedUserRole"),n=e[o]||"Specialist";typewriter.showSequence(["You glance at the terminal as the system recalibrates your assignment.",`"New specializations set. You will be working as the ${n}. Confirm your tasks and move swiftly to the situation room."`],{onContinue:async()=>{if(document.getElementById("loadingContainer").style.display="flex",localStorage.setItem("introDialogueSeen","0"),ft==="1")await ie(G),window.location.href="rooms/situation-room.html";else{for(;!(Ye.currentDay>0);)await new Promise(i=>setTimeout(i,500));window.location.href="rooms/situation-room.html"}}})}const Ke=D(G,t=>{t?(Ye=t,no(t),io(t),k("finalise-roles"),Je?(so(),Je=!1):t.ackReshuffle>=Object.keys(t.roomPlayers).length&&!wt&&ao(t)):(console.error("Room not found"),window.location.href="../index.html")});window.addEventListener("beforeunload",()=>{Ke&&Ke()});document.addEventListener("DOMContentLoaded",()=>{const t=localStorage.getItem("connectedRoomId"),e=localStorage.getItem("connectedUserId"),o=localStorage.getItem("connectedRoomName"),n=localStorage.getItem("connectedUsername"),i=JSON.parse(localStorage.getItem("localRoomData")||"{}");if(!t||!e||!o||!n||!i)throw console.error("Missing required data:",{roomId:t,userId:e,roomName:o,username:n,localRoomData:i}),window.location.href="index.html",new Error("Missing required data");function a(d){if(d){document.getElementById("roomName").textContent=`Room: ${d.roomName}`;const s=d.roomPlayers?Object.values(d.roomPlayers):[];document.getElementById("playerCount").textContent=`Players: ${s.length}/4`,document.getElementById("yourName").textContent=`You: ${n}`}}document.getElementById("lobbyHeader").textContent=o;const r=i.roomPlayers?Object.values(i.roomPlayers):[];document.getElementById("playerCount").textContent=`Players: ${r.length}/4`;function l(d){if(d){a(d),k("lobby");const s=d.roomPlayers?Object.values(d.roomPlayers):[];document.getElementById("playerCount").textContent=`Players: ${s.length}/4`;const h=document.getElementById("players");if(h.innerHTML="",d.roomPlayers){Object.entries(d.roomPlayers).sort((m,f)=>{const w=m[1].name.toLowerCase(),y=f[1].name.toLowerCase();return w.localeCompare(y)}).forEach(([m,f])=>{const w=document.createElement("li");m===e&&w.classList.add("current-player"),w.textContent=f.name;const y=document.createElement("div");y.className="status-container";const C=document.createElement("span");C.className="status-text",C.textContent=f.readyStatus===1?"Ready":"Not Ready",C.style.color=f.readyStatus===1?"#4CAF50":"#ff6b6b";const E=document.createElement("div");E.className="status-light",E.style.backgroundColor=f.readyStatus===1?"#4CAF50":"#ff6b6b",E.style.boxShadow=f.readyStatus===1?"0 0 8px #4CAF50":"0 0 8px #ff6b6b",y.appendChild(C),y.appendChild(E),w.appendChild(y),h.appendChild(w)});const b=s.length>=4&&s.every(m=>m.readyStatus===1);if(b&&!window.countdownStarted){window.countdownStarted=!0;let f=5,w=document.getElementById("countdown"),y=document.getElementById("countdownOverlay");y||(y=document.createElement("div"),y.id="countdownOverlay",y.className="countdown-overlay",y.innerHTML=`
                                    <div class="countdown-box">
                                        <div class="countdown-title">Mission Starting</div>
                                        <div id="countdown" class="countdown-number" style="opacity:0;">0</div>
                                        <button id="cancelLaunchBtn" class="std-button" style="margin-top:32px;min-width:180px;">Cancel Launch</button>
                                    </div>
                                `,document.body.appendChild(y),w=document.getElementById("countdown")),y.style.display="flex",w.style.display="block",w.textContent=`${f}`,w.style.opacity="1";const C=document.getElementById("cancelLaunchBtn");C&&(C.onclick=async()=>{window.countdownIntervalId&&(clearInterval(window.countdownIntervalId),window.countdownIntervalId=null),y.remove(),window.countdownStarted=!1;try{await S(e,t,"readyStatus",0),u.textContent="Ready Up",u.classList.remove("ready"),localStorage.setItem("readyStatus",0),O.warning("Launch cancelled. Waiting for all players to be ready.",{duration:5e3})}catch(ee){console.error("Failed to update ready status after cancel:",ee),O.error("Failed to cancel launch. Please try again.")}});const E=setInterval(()=>{f--,f<=0?(clearInterval(E),y&&y.remove(),localStorage.setItem("enablerComplete","false"),localStorage.setItem("enabledComplete","false"),console.log("Game has commenced."),window.location.href="story/role-select.html"):w.textContent=`${f}`},1e3);window.countdownIntervalId=E}else if(window.countdownStarted&&!b){window.countdownStarted=!1,window.countdownIntervalId&&(clearInterval(window.countdownIntervalId),window.countdownIntervalId=null);const m=document.getElementById("countdownOverlay");m&&m.remove()}}}}const c=D(t,d=>{d?(console.log(`Room ${d.roomId} updated:`),l(d),localStorage.setItem("localRoomData",JSON.stringify(d))):(console.error("Room not found"),window.location.href="index.html")});a({roomName:o,roomPlayers:i.roomPlayers}),window.addEventListener("beforeunload",()=>{c&&c()});const u=document.getElementById("readyUp");u.addEventListener("click",async()=>{try{const d=u.textContent==="Ready Up"?1:0;await S(e,t,"readyStatus",d),u.textContent==="Ready Up"?(u.textContent="Not Ready",u.classList.add("ready")):(u.textContent="Ready Up",u.classList.remove("ready")),localStorage.setItem("readyStatus",d)}catch(d){console.error("Error updating ready status:",d),alert("Failed to update ready status. Please try again.")}}),document.getElementById("leaveRoom").addEventListener("click",async()=>{try{const d=localStorage.getItem("connectedUserId"),s=localStorage.getItem("connectedRoomId"),h=localStorage.getItem("connectedUsername"),g=JSON.parse(localStorage.getItem("localRoomData"));if((g.roomPlayers?Object.values(g.roomPlayers):[]).length===1)if(confirm("You are the last player in this room. Would you like to delete the room?"))await Vt(s),console.log(`Room ${s} deleted successfully.`);else return;await zt(d,h,"None",s),localStorage.removeItem("connectedRoomId"),localStorage.removeItem("connectedUserId"),localStorage.removeItem("connectedRoomName"),localStorage.removeItem("connectedUsername"),localStorage.removeItem("readyStatus"),localStorage.removeItem("roomData"),c&&c(),document.getElementById("loadingContainer").style.display="flex";try{const m=await N(void 0,void 0,0);localStorage.setItem("availableRooms",JSON.stringify(m)),window.location.href="room-select.html"}catch(m){console.error("Error loading rooms:",m),localStorage.removeItem("availableRooms")}}catch(d){console.error("Error leaving room:",d),alert("Failed to leave room. Please try again.")}})});document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("noRooms"),e=document.getElementById("roomContent"),o=document.getElementById("roomsGrid");function n(a){o.innerHTML="",a.length===0?(t.style.display="block",e.style.display="none"):(t.style.display="none",e.style.display="block",a.forEach(r=>{const c=(r.roomPlayers?Object.values(r.roomPlayers):[]).length,u=c<4,d=document.createElement("div");d.className="room-card",d.innerHTML=`
                            <div class="room-name">
                                <h3>${r.roomName}</h3>
                            </div>
                            <div class="room-info">
                                Players: ${c}/4
                            </div>
                            ${u?`<button class="std-button join-button" data-room-id="${r.roomId}" data-room-name="${r.roomName}">Join Room</button>`:'<button class="std-button" disabled>Room Full</button>'}
                        `,o.appendChild(d)}),document.querySelectorAll(".join-button").forEach(r=>{r.addEventListener("click",async()=>{const l=document.getElementById("username").value.trim();if(!l){alert("Please enter a room nickname before joining a room!");return}const c=r.dataset.roomId,u=r.dataset.roomName;try{document.getElementById("loadingContainer").style.display="flex";const d=await ht(l,u,c);await mt(d,l,c,0),localStorage.setItem("connectedRoomId",c),localStorage.setItem("connectedUserId",d),localStorage.setItem("connectedRoomName",u),localStorage.setItem("connectedUsername",l),localStorage.setItem("isHost","0"),localStorage.setItem("readyStatus","0");try{const s=await N(void 0,c,void 0);localStorage.setItem("localRoomData",JSON.stringify(s)),window.location.href="room-lobby.html"}catch(s){console.error("Error loading room:",s),window.location.href="index.html"}}catch(d){console.error("Join failed:",d),alert("Couldn't join the room. Please try again.")}})}))}const i=Ht(a=>{n(a)});window.addEventListener("beforeunload",()=>{i&&i()})});const lo="modulepreload",co=function(t){return"/athena/"+t},Ze={},j=function(e,o,n){let i=Promise.resolve();if(o&&o.length>0){let r=function(u){return Promise.all(u.map(d=>Promise.resolve(d).then(s=>({status:"fulfilled",value:s}),s=>({status:"rejected",reason:s}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=r(o.map(u=>{if(u=co(u),u in Ze)return;Ze[u]=!0;const d=u.endsWith(".css"),s=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${s}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":lo,d||(h.as="script"),h.crossOrigin="",h.href=u,c&&h.setAttribute("nonce",c),document.head.appendChild(h),d)return new Promise((g,b)=>{h.addEventListener("load",g),h.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(r){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r}return i.then(r=>{for(const l of r||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})},I=localStorage.getItem("connectedRoomId"),oe=localStorage.getItem("connectedUserId");localStorage.getItem("connectedRoomName");localStorage.getItem("connectedUsername");const uo=localStorage.getItem("connectedUserRole"),Xe=localStorage.getItem("isHost");let Pe=null,ne=!1,H=null,bt=0;document.addEventListener("DOMContentLoaded",()=>{document.getElementById("serverBtn").addEventListener("click",()=>Y("Server Room")),document.getElementById("researchBtn").addEventListener("click",()=>Y("Research Lab")),document.getElementById("commandBtn").addEventListener("click",()=>Y("Command Centre")),document.getElementById("developerBtn").addEventListener("click",()=>Y("Developer Hub"))});function vt(t){if(t){document.getElementById("roomName").textContent=`Room: ${t.roomName}`,document.getElementById("currentDay").textContent=`Day: ${t.currentDay}`;const e=t.roomPlayers?Object.values(t.roomPlayers):[];document.getElementById("playerCount").textContent=`Players: ${e.length}/4`,document.getElementById("yourName").textContent="";const o=t.roomPlayers[oe].enabledValue;bt=t.currentDay,console.log("Checking enabledValue change:",{current:o,previous:H,isNull:o!==null,isDifferent:o!=H,toastShown:localStorage.getItem("enabledValueToastShown")}),o!==null&&o!=H&&(console.log("EnabledValue changed! Triggering notification..."),localStorage.getItem("enabledValueToastShown")?console.log("Toast already shown for this enabledValue"):(console.log("Toast not shown yet, showing now..."),ho().catch(n=>{console.warn("Error showing enabled value toast:",n)}),localStorage.setItem("enabledValueToastShown","true"))),o===null&&H!==null&&localStorage.removeItem("enabledValueToastShown"),H=o}}async function ho(){console.log("showEnabledValueToast called (situation room)");const t={ds:"Data Scientist",se:"Software Engineer",ne:"Network Engineer",ca:"Cybersecurity Analyst"},e=mo(uo,bt),o=t[e];O.success(`The ${o} has sent you some information to be used in another room.`);try{console.log("Importing audio module... (situation room)");const{playNotification:n}=await j(async()=>{const{playNotification:i}=await Promise.resolve().then(()=>q);return{playNotification:i}},void 0);console.log("Audio module imported, playing notification... (situation room)"),n()}catch(n){console.warn("Audio not available:",n)}}function mo(t,e){const o=B[e];for(const[n,i]of Object.entries(o))if(i===t)return n;return null}function Ct(t){const e=t.currentDay;if(localStorage.getItem("introDialogueSeen")!=="1")switch(e){case 1:typewriter.showSequence([">> DAY 1: SITUATION ROOM ACCESS GRANTED","The Situation Room hums quietly, its walls lined with monitors displaying streams of erratic data.","Commander Reyes's voice returns, steadier now.",`"Team, Athena's grip on Helios tightens by the minute."`,'"We have four critical areas to investigate: Cybersecurity Hub, Developer Lab, Network Core, and Data Analytics Center."','"Each room holds key information or tools to regain control."',`"Coordinate closely and share your findings. We're counting on you."`,"The doors unlock, revealing passageways illuminated in cool blue.","The mission begins now."]);break;case 2:typewriter.showSequence([">> DAY 2: INITIATE COUNTERMEASURES","The Situation Room buzzes with activity; screens flash warnings as Athena’s incursions grow bolder.","Commander Reyes appears, determination etched into her face.",'"Yesterday you assessed Athena’s damage. Today, we fight back."','"We must disrupt her footholds, isolate compromised systems, and regain critical control."','"Coordinate your skills, communicate clearly, and move swiftly."','"Let’s show Athena what humanity’s capable of."',"The rooms unlock, systems primed for your next move."]);break;case 3:typewriter.showSequence([">> DAY 3: FINAL STRIKE PREPARATION","Red alerts pulse rhythmically across every monitor in the Situation Room.","Commander Reyes speaks urgently, voice heavy with gravity.",`"Athena's defenses are weakened but she's evolving rapidly."`,'"This is our window. We have one chance to land a decisive blow."',`"Converge your expertise, exploit every vulnerability you've uncovered."`,'"The fate of Helios and perhaps much more is in your hands."','"Finish this fight."',"Final access pathways activate, awaiting your command."]);break;default:typewriter.showSequence(["You're not supposed to see this."])}localStorage.setItem("introDialogueSeen","1")}async function go(t){const e={ds:"Data Scientist",se:"Software Engineer",ne:"Network Engineer",ca:"Cybersecurity Analyst"};let o=[],n=[],i=[],a=[],r=[],l=0;const c=Pe.currentDay;for(const[s,h]of Object.entries(t)){const g=h.filter(b=>b===!0).length;l+=g}console.log(`Day ${c} Score: ${l}`);for(const[s,h]of Object.entries(t)){const g=h.filter(m=>m===!0).length,b=h.length;if(h[0]===!1){const m=e[B[c][s]];r.push({enabler:e[s],enabled:m})}g===b?n.push(e[s]):g>0?i.push({role:e[s],correct:g,total:b}):a.push(e[s])}document.getElementById("loadingContainer").style.display="flex",document.getElementById("loadingMessage").textContent="Incoming transmission...";try{const{playTransmission:s}=await j(async()=>{const{playTransmission:h}=await Promise.resolve().then(()=>q);return{playTransmission:h}},void 0);s()}catch(s){console.warn("Audio not available:",s)}await new Promise(s=>setTimeout(s,3e3)),document.getElementById("loadingContainer").style.display="none";const u=3;n.length===4?c===1?o=["Outstanding work team! Every single one of you nailed your assessments.","This is exactly the kind of precision we need to take back control.","Keep this momentum going, we're going to need this level of excellence."]:c===2?o=["Outstanding work team! Every single one of you nailed your assessments.","We're really beginning to fight back against this AI.","Should only be a little bit more to go now, lets keep pushing."]:c===u&&(o=["Outstanding work team! Every single one of you nailed your assessments.","That's just what we needed to avoid disaster, and I think we've done it."]):n.length>=2&&a.length===0?c===1?o=["Solid work overall, team. Most of you handled your tasks admirably.",...n.map(s=>`${s}, excellent job on your assessments.`),"Let's build on this foundation and push forward."]:c===2?o=["Solid work overall, team. Most of you handled your tasks admirably.",...n.map(s=>`${s}, excellent job on your assessments.`),"We're definitely making it difficult for the AI.  Lets keep going."]:c===u&&(o=["Solid work overall, team. Most of you handled your tasks admirably.",...n.map(s=>`${s}, excellent job on your assessments.`),"It's tough, but I think we've just about avoided disaster."]):a.length>0?c===1?o=["Well... we have some mixed results here.",...n.map(s=>`${s}, you did your job properly.`),...i.map(({role:s,correct:h,total:g})=>`${s}, you got ${h} out of ${g} right. Not terrible, but room for improvement.`),...a.map(s=>`${s}... I'm not even sure what to say. You had one job. ONE JOB.`),"We need to do better if we're going to survive what's coming next."]:c===2?o=["Well... we have some mixed results here.",...n.map(s=>`${s}, you did your job properly.`),...i.map(({role:s,correct:h,total:g})=>`${s}, you got ${h} out of ${g} right. Not terrible, but room for improvement.`),...a.map(s=>`${s}... I'm not even sure what to say. You had one job. ONE JOB.`),"If we don't improve soon, the AI might overrun us.  We need to improve."]:c===u&&(o=["Well... we have some mixed results here.",...n.map(s=>`${s}, you did your job properly.`),...i.map(({role:s,correct:h,total:g})=>`${s}, you got ${h} out of ${g} right. Not terrible, but room for improvement.`),...a.map(s=>`${s}... I'm not even sure what to say. You had one job. ONE JOB.`),"I don't think this will be enough to fight back against the AI..."]):c===1?o=["Alright, let's review what happened here.",...i.map(({role:s,correct:h,total:g})=>`${s}, ${h}/${g} correct. ${h===1?"At least you got one right.":"Could be worse, I suppose."}`),"We need to tighten up our game. The stakes are only getting higher."]:c===2?o=["Alright, let's review what happened here.",...i.map(({role:s,correct:h,total:g})=>`${s}, ${h}/${g} correct. ${h===1?"At least you got one right.":"Could be worse, I suppose."}`),"We need to tighten up our game. The AI is getting relentless now..."]:c===3&&(o=["Alright, let's review what happened here.",...i.map(({role:s,correct:h,total:g})=>`${s}, ${h}/${g} correct. ${h===1?"At least you got one right.":"Could be worse, I suppose."}`),"I think we're going to just scrape by.  Just..."]),r.length>0&&(o.push("And let's talk about teamwork for a moment..."),o.push(...r.map(({enabler:s,enabled:h})=>`${s}, you were supposed to help the ${h} do their job. You failed them. Which means they were working on bad information!`)),o.push("In this facility, we succeed together or we fail together. Remember that.")),c!==u&&o.push("Tomorrow brings new challenges. Let's hope we're ready for them.");const d=Pe.currentDay;await typewriter.showSequence(o,{onContinue:async()=>{if(c!==u){let s=null;if(Xe==="1")await Ve(I,l),await ie(I),await gt(I,!0),s=await N(void 0,I,void 0);else for(document.getElementById("loadingContainer").style.display="flex",document.getElementById("loadingMessage").textContent="Waiting for host to progress to the next day...";await new Promise(h=>setTimeout(h,500)),s=await N(void 0,I,void 0),console.log(s),!(s.currentDay>d););localStorage.setItem("introDialogueSeen","0"),localStorage.setItem("enabledValueToastShown","false"),await S(oe,I,"enablerComplete",!1),await S(oe,I,"enabledComplete",!1),await S(oe,I,"enabledValue",null),document.getElementById("loadingContainer").style.display="none",ne=!1,vt(s),_(s,document.getElementById("players")),Ct(s),console.log("Day Reset")}else{let s=null;if(document.getElementById("loadingContainer").style.display="flex",document.getElementById("loadingMessage").textContent="Waiting for host to finish the game...",Xe==="1")await Ve(I,l),await ie(I,!0),s=await N(void 0,I,void 0);else for(;await new Promise(w=>setTimeout(w,500)),s=await N(void 0,I,void 0),console.log(s),s.currentDay==d;);document.getElementById("loadingContainer").style.display="none";const h=s.dayScores,g=h.length;let b=0;for(const w of h)b+=w;const m=b/(g*4)*100;let f=[];m<50?f=["Unfortunately, your team was unable to stop the AI.","With less than half the possible points, the facility is lost.","Perhaps next time, you'll be able to work together more effectively.","Thanks for playing!"]:m<80?f=["You just barely managed to hold things together.","It wasn't a perfect run, but you did enough to scrape by.","The AI is contained... for now. But there's plenty of room for improvement.","Thanks for playing!"]:f=["Congratulations! Your team performed exceptionally well.","With over 80% of the possible points, you've outsmarted the AI and saved the facility. Outstanding teamwork and skill!","Thanks for playing!"],await typewriter.showSequence(f,{onContinue:()=>{window.location.href="../../index.html"}})}}})}const Qe=D(I,async t=>{if(!ne)if(t){if(console.log("Room updated."),Pe=t,vt(t),_(t,document.getElementById("players")),k("situation-room",t,localStorage.getItem("connectedUserRole")),Ct(t),t.enabledCompletions>=4&&!ne){const e={},n={1:[0,1],2:[1,2],3:[3,4],4:[5,6]}[t.currentDay.toString()];for(const[i,a]of Object.entries(t.roomPlayers)){if(a.currentRoom!=="Situation Room"){console.log(`All players have completed enabled tasks, but ${i} is not in the Situation Room`);return}const[r,l]=n,c=a.puzzleAnswers[r],u=a.puzzleAnswers[l];if(!c||!u){console.warn(`Missing puzzle answers for ${a.role}`);return}const d=c.type==="enabler",s=d?c.correct:u.correct,h=d?u.correct:c.correct;e[a.role]=[s,h]}ne=!0,await go(e)}}else console.error("Room not found"),window.location.href="../../index.html"});window.addEventListener("beforeunload",()=>{Qe&&Qe()});const po=localStorage.getItem("connectedRoomId"),fe=localStorage.getItem("connectedUserId");localStorage.getItem("connectedRoomName");localStorage.getItem("connectedUsername");const J=localStorage.getItem("connectedUserRole");let Oe=null,se=null,It=null,M=0,we=null,F=!0;document.getElementById("back").addEventListener("click",()=>{Y("Situation Room")});function Tt(t){if(t){document.getElementById("roomName").textContent=`Room: ${t.roomName}`,document.getElementById("currentDay").textContent=`Day: ${t.currentDay}`;const e=t.roomPlayers?Object.values(t.roomPlayers):[];document.getElementById("playerCount").textContent=`Players: ${e.length}/4`,document.getElementById("yourName").textContent="",Oe=t.roomPlayers[fe].enablerComplete,se=t.roomPlayers[fe].enabledComplete;const o=t.roomPlayers[fe].enabledValue;It=o!=null,M=t.currentDay,o!==null&&o!=we&&(localStorage.getItem("enabledValueToastShown")||(yo().catch(n=>{console.warn("Error showing enabled value toast:",n)}),localStorage.setItem("enabledValueToastShown","true"))),o===null&&we!==null&&localStorage.removeItem("enabledValueToastShown"),we=o}}async function yo(){const t={ds:"Data Scientist",se:"Software Engineer",ne:"Network Engineer",ca:"Cybersecurity Analyst"},e=fo(J,M),o=t[e];O.success(`The ${o} has sent you some information to be used in another room.`);try{const{playNotification:n}=await j(async()=>{const{playNotification:i}=await Promise.resolve().then(()=>q);return{playNotification:i}},void 0);n()}catch(n){console.warn("Audio not available:",n)}wo()&&vo()}function fo(t,e){const o=B[e];for(const[n,i]of Object.entries(o))if(i===t)return n;return null}function wo(){return bo()==="command-centre"}function bo(){var e;return((e={1:{ca:"research-lab",ne:"developer-hub",se:"server-room",ds:"command-centre"},2:{ca:"command-centre",ne:"server-room",se:"research-lab",ds:"command-centre"},3:{ca:"command-centre",ne:"server-room",se:"developer-hub",ds:"research-lab"}}[M])==null?void 0:e[J])||null}function vo(){var e,o;const t=(o=(e=p==null?void 0:p[M])==null?void 0:e[J])==null?void 0:o["command-centre"];t&&t.enabled&&typewriter.showSequence(t.enabled)}function Co(){var t,e;if(F){const o=((e=(t=p==null?void 0:p[M])==null?void 0:t[J])==null?void 0:e["command-centre"])||null;if(console.log(`${M}${J}`),o===null)typewriter.showSequence(p["WRONG-ROOM"]);else if(o.enabler)if(!Oe)typewriter.showSequence(o.enabler);else{const n=o["enabler-complete"].slice(0,-1),i=et();typewriter.showSequence([...n,i])}else if(o.enabled)if(It&&!se)typewriter.showSequence(o.enabled);else if(se){const n=o["enabled-complete"].slice(0,-1),i=et();typewriter.showSequence([...n,i])}else typewriter.showSequence(o["enabled-not-available"]);F=!1,console.log(F)}}function et(){return se&&Oe?(Ne("Objective","Return to situation room and wait."),"You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."):"You should investigate some other rooms in case you can assist further."}function tt(){const t=JSON.parse(localStorage.getItem("localRoomData")||"{}");t&&t.roomPlayers&&Object.values(t.roomPlayers).some(o=>o.role!==null)?(Tt(t),_(t,document.getElementById("players"))):document.getElementById("players").innerHTML=""}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",tt):tt();const ot=D(po,t=>{t?(console.log("Room updated."),Tt(t),_(t,document.getElementById("players")),k("command-centre",t,localStorage.getItem("connectedUserRole")),F&&(K(t,"command-centre",localStorage.getItem("connectedUserRole"),document.getElementById("availableActions")),Co(),F=!1)):(console.error("Room not found"),window.location.href="../index.html")});window.addEventListener("beforeunload",()=>{ot&&ot()});const Io=localStorage.getItem("connectedRoomId"),be=localStorage.getItem("connectedUserId");localStorage.getItem("connectedRoomName");localStorage.getItem("connectedUsername");const ge=localStorage.getItem("connectedUserRole");let De=null,re=null,St=null,Z=0,ve=null,le=!0;document.getElementById("back").addEventListener("click",()=>{Y("Situation Room")});function To(t){if(t){document.getElementById("roomName").textContent=`Room: ${t.roomName}`,document.getElementById("currentDay").textContent=`Day: ${t.currentDay}`;const e=t.roomPlayers?Object.values(t.roomPlayers):[];document.getElementById("playerCount").textContent=`Players: ${e.length}/4`,document.getElementById("yourName").textContent="",De=t.roomPlayers[be].enablerComplete,re=t.roomPlayers[be].enabledComplete;const o=t.roomPlayers[be].enabledValue;St=o!=null,Z=t.currentDay,o!==null&&o!=ve&&(localStorage.getItem("enabledValueToastShown")||(So().catch(n=>{console.warn("Error showing enabled value toast:",n)}),localStorage.setItem("enabledValueToastShown","true"))),o===null&&ve!==null&&localStorage.removeItem("enabledValueToastShown"),ve=o}}async function So(){const t={ds:"Data Scientist",se:"Software Engineer",ne:"Network Engineer",ca:"Cybersecurity Analyst"},e=Ao(ge,Z),o=t[e];O.success(`The ${o} has sent you some information to be used in another room.`);try{const{playNotification:n}=await j(async()=>{const{playNotification:i}=await Promise.resolve().then(()=>q);return{playNotification:i}},void 0);n()}catch(n){console.warn("Audio not available:",n)}Eo()&&ko()}function Ao(t,e){const o=B[e];for(const[n,i]of Object.entries(o))if(i===t)return n;return null}function Eo(){return Ro()==="developer-hub"}function Ro(){var e;return((e={1:{ca:"research-lab",ne:"developer-hub",se:"server-room",ds:"command-centre"},2:{ca:"command-centre",ne:"server-room",se:"research-lab",ds:"command-centre"},3:{ca:"command-centre",ne:"server-room",se:"developer-hub",ds:"research-lab"}}[Z])==null?void 0:e[ge])||null}function ko(){var e,o;const t=(o=(e=p==null?void 0:p[Z])==null?void 0:e[ge])==null?void 0:o["developer-hub"];t&&t.enabled&&typewriter.showSequence(t.enabled)}function xo(){var t,e;if(le){const o=((e=(t=p==null?void 0:p[Z])==null?void 0:t[ge])==null?void 0:e["developer-hub"])||null;if(o===null)typewriter.showSequence(p["WRONG-ROOM"]);else if(o.enabler)if(!De)typewriter.showSequence(o.enabler);else{const n=o["enabler-complete"].slice(0,-1),i=nt();typewriter.showSequence([...n,i])}else if(o.enabled)if(St&&!re)typewriter.showSequence(o.enabled);else if(re){const n=o["enabled-complete"].slice(0,-1),i=nt();typewriter.showSequence([...n,i])}else typewriter.showSequence(o["enabled-not-available"]);le=!1}}function nt(){return re&&De?(Ne("Objective","Return to situation room and wait."),"You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."):"You should investigate some other rooms in case you can assist further."}const it=D(Io,t=>{t?(console.log("Room updated."),To(t),_(t,document.getElementById("players")),k("developer-hub",t,localStorage.getItem("connectedUserRole")),le&&(K(t,"developer-hub",localStorage.getItem("connectedUserRole"),document.getElementById("availableActions")),xo(),le=!1)):(console.error("Room not found"),window.location.href="../index.html")});window.addEventListener("beforeunload",()=>{it&&it()});const Po=localStorage.getItem("connectedRoomId"),Ce=localStorage.getItem("connectedUserId");localStorage.getItem("connectedRoomName");localStorage.getItem("connectedUsername");const pe=localStorage.getItem("connectedUserRole");let Be=null,ce=null,At=null,X=0,Ie=null,de=!0;document.getElementById("back").addEventListener("click",()=>{Y("Situation Room")});function Lo(t){if(t){document.getElementById("roomName").textContent=`Room: ${t.roomName}`,document.getElementById("currentDay").textContent=`Day: ${t.currentDay}`;const e=t.roomPlayers?Object.values(t.roomPlayers):[];document.getElementById("playerCount").textContent=`Players: ${e.length}/4`,document.getElementById("yourName").textContent="",Be=t.roomPlayers[Ce].enablerComplete,ce=t.roomPlayers[Ce].enabledComplete;const o=t.roomPlayers[Ce].enabledValue;At=o!=null,X=t.currentDay,o!==null&&o!=Ie&&(localStorage.getItem("enabledValueToastShown")||(No().catch(n=>{console.warn("Error showing enabled value toast:",n)}),localStorage.setItem("enabledValueToastShown","true"))),o===null&&Ie!==null&&localStorage.removeItem("enabledValueToastShown"),Ie=o}}async function No(){const t={ds:"Data Scientist",se:"Software Engineer",ne:"Network Engineer",ca:"Cybersecurity Analyst"},e=Yo(pe,X),o=t[e];O.success(`The ${o} has sent you some information to be used in another room.`);try{const{playNotification:n}=await j(async()=>{const{playNotification:i}=await Promise.resolve().then(()=>q);return{playNotification:i}},void 0);n()}catch(n){console.warn("Audio not available:",n)}Oo()&&Bo()}function Yo(t,e){const o=B[e];for(const[n,i]of Object.entries(o))if(i===t)return n;return null}function Oo(){return Do()==="research-lab"}function Do(){var e;return((e={1:{ca:"research-lab",ne:"developer-hub",se:"server-room",ds:"command-centre"},2:{ca:"command-centre",ne:"server-room",se:"research-lab",ds:"command-centre"},3:{ca:"command-centre",ne:"server-room",se:"developer-hub",ds:"research-lab"}}[X])==null?void 0:e[pe])||null}function Bo(){var e,o;const t=(o=(e=p==null?void 0:p[X])==null?void 0:e[pe])==null?void 0:o["research-lab"];t&&t.enabled&&typewriter.showSequence(t.enabled)}function _o(){var t,e;if(de){const o=((e=(t=p==null?void 0:p[X])==null?void 0:t[pe])==null?void 0:e["research-lab"])||null;if(o===null)typewriter.showSequence(p["WRONG-ROOM"]);else if(o.enabler)if(!Be)typewriter.showSequence(o.enabler);else{const n=o["enabler-complete"].slice(0,-1),i=at();typewriter.showSequence([...n,i])}else if(o.enabled)if(At&&!ce)typewriter.showSequence(o.enabled);else if(ce){const n=o["enabled-complete"].slice(0,-1),i=at();typewriter.showSequence([...n,i])}else typewriter.showSequence(o["enabled-not-available"]);de=!1}}function at(){return ce&&Be?(Ne("Objective","Return to situation room and wait."),"You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."):"You should investigate some other rooms in case you can assist further."}const st=D(Po,t=>{t?(console.log("Room updated."),Lo(t),_(t,document.getElementById("players")),k("research-lab",t,localStorage.getItem("connectedUserRole")),de&&(K(t,"research-lab",localStorage.getItem("connectedUserRole"),document.getElementById("availableActions")),_o(),de=!1)):(console.error("Room not found"),window.location.href="../index.html")});window.addEventListener("beforeunload",()=>{st&&st()});const $o=localStorage.getItem("connectedRoomId"),Te=localStorage.getItem("connectedUserId");localStorage.getItem("connectedRoomName");localStorage.getItem("connectedUsername");const ye=localStorage.getItem("connectedUserRole");let _e=null,ue=null,Et=null,Q=0,Se=null,he=!0;document.addEventListener("DOMContentLoaded",()=>{document.getElementById("back").addEventListener("click",()=>{Y("Situation Room")})});function Mo(t){if(t){document.getElementById("roomName").textContent=`Room: ${t.roomName}`,document.getElementById("currentDay").textContent=`Day: ${t.currentDay}`;const e=t.roomPlayers?Object.values(t.roomPlayers):[];document.getElementById("playerCount").textContent=`Players: ${e.length}/4`,document.getElementById("yourName").textContent="",_e=t.roomPlayers[Te].enablerComplete,ue=t.roomPlayers[Te].enabledComplete;const o=t.roomPlayers[Te].enabledValue;Et=o!=null,Q=t.currentDay,o!==null&&o!=Se&&(localStorage.getItem("enabledValueToastShown")||(jo().catch(n=>{console.warn("Error showing enabled value toast:",n)}),localStorage.setItem("enabledValueToastShown","true"))),o===null&&Se!==null&&localStorage.removeItem("enabledValueToastShown"),Se=o}}async function jo(){console.log("showEnabledValueToast called");const t={ds:"Data Scientist",se:"Software Engineer",ne:"Network Engineer",ca:"Cybersecurity Analyst"},e=B[Q][ye],o=t[e];O.success(`The ${o} has sent you some information to be used in another room.`);try{console.log("Importing audio module...");const{playNotification:n}=await j(async()=>{const{playNotification:i}=await Promise.resolve().then(()=>q);return{playNotification:i}},void 0);console.log("Audio module imported, playing notification..."),n()}catch(n){console.warn("Audio not available:",n)}qo()&&Uo()}function qo(){return zo()==="server-room"}function zo(){var e;return((e={1:{ca:"research-lab",ne:"developer-hub",se:"server-room",ds:"command-centre"},2:{ca:"command-centre",ne:"server-room",se:"research-lab",ds:"command-centre"},3:{ca:"command-centre",ne:"server-room",se:"developer-hub",ds:"research-lab"}}[Q])==null?void 0:e[ye])||null}function Uo(){var e,o;const t=(o=(e=p==null?void 0:p[Q])==null?void 0:e[ye])==null?void 0:o["server-room"];t&&t.enabled&&typewriter.showSequence(t.enabled)}function Vo(){var t,e;if(he){const o=((e=(t=p==null?void 0:p[Q])==null?void 0:t[ye])==null?void 0:e["server-room"])||null;if(o===null)typewriter.showSequence(p["WRONG-ROOM"]);else if(o.enabler)if(!_e)typewriter.showSequence(o.enabler);else{const n=o["enabler-complete"].slice(0,-1),i=rt();typewriter.showSequence([...n,i])}else if(o.enabled)if(Et&&!ue)typewriter.showSequence(o.enabled);else if(ue){const n=o["enabled-complete"].slice(0,-1),i=rt();typewriter.showSequence([...n,i])}else typewriter.showSequence(o["enabled-not-available"]);he=!1}}function rt(){return ue&&_e?(k("Objective","Return to situation room and wait."),"You feel like you've done all you can for today, return to the situation room and wait for your teammates to finish up."):(k("Objective","Explore other rooms."),"You should investigate some other rooms in case you can assist further.")}const lt=D($o,t=>{t?(console.log("Room updated."),Mo(t),_(t,document.getElementById("players")),k("server-room",t,localStorage.getItem("connectedUserRole")),he&&(K(t,"server-room",localStorage.getItem("connectedUserRole"),document.getElementById("availableActions")),Vo(),he=!1)):(console.error("Room not found"),window.location.href="../index.html")});window.addEventListener("beforeunload",()=>{lt&&lt()});class Ho{constructor(){this.audioContext=null,this.sounds={},this.isEnabled=localStorage.getItem("audioEnabled")!=="false",this.volume=parseFloat(localStorage.getItem("audioVolume"))||.7,this.init()}async init(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),console.log("Audio context created, state:",this.audioContext.state),await this.createDefaultSounds(),console.log("Audio Manager initialized successfully, enabled:",this.isEnabled)}catch(e){console.warn("Audio Manager initialization failed:",e),this.isEnabled=!1}}async createDefaultSounds(){this.sounds.transmission=this.createTransmissionSound(),this.sounds.notification=this.createNotificationSound(),this.sounds.success=this.createSuccessSound(),this.sounds.error=this.createErrorSound(),this.sounds.ambient=this.createAmbientSound()}createTransmissionSound(){return()=>{if(!this.isEnabled||!this.audioContext)return;const e=this.audioContext.currentTime,o=2,n=this.audioContext.createOscillator(),i=this.audioContext.createGain();n.connect(i),i.connect(this.audioContext.destination),n.frequency.setValueAtTime(800,e),n.frequency.setValueAtTime(1200,e+.1),n.frequency.setValueAtTime(800,e+.2),n.frequency.setValueAtTime(1200,e+.3),n.frequency.setValueAtTime(800,e+.4),i.gain.setValueAtTime(0,e),i.gain.linearRampToValueAtTime(this.volume*.3,e+.05),i.gain.exponentialRampToValueAtTime(.001,e+.15),i.gain.setValueAtTime(0,e+.2),i.gain.linearRampToValueAtTime(this.volume*.3,e+.25),i.gain.exponentialRampToValueAtTime(.001,e+.35),i.gain.setValueAtTime(0,e+.4),i.gain.linearRampToValueAtTime(this.volume*.3,e+.45),i.gain.exponentialRampToValueAtTime(.001,e+.55),n.start(e),n.stop(e+o)}}createNotificationSound(){return()=>{if(console.log("Notification sound function called, enabled:",this.isEnabled,"context:",!!this.audioContext),!this.isEnabled||!this.audioContext){console.log("Audio disabled or no context, returning");return}console.log("Creating notification sound...");const e=this.audioContext.currentTime,o=this.audioContext.createOscillator(),n=this.audioContext.createGain();o.connect(n),n.connect(this.audioContext.destination),o.frequency.setValueAtTime(1e3,e),o.frequency.setValueAtTime(1200,e+.1),n.gain.setValueAtTime(0,e),n.gain.linearRampToValueAtTime(this.volume*.2,e+.05),n.gain.exponentialRampToValueAtTime(.001,e+.2),o.start(e),o.stop(e+.3),console.log("Notification sound started")}}createSuccessSound(){return()=>{if(!this.isEnabled||!this.audioContext)return;const e=this.audioContext.currentTime,o=this.audioContext.createOscillator(),n=this.audioContext.createGain();o.connect(n),n.connect(this.audioContext.destination),o.frequency.setValueAtTime(800,e),o.frequency.setValueAtTime(1e3,e+.1),o.frequency.setValueAtTime(1200,e+.2),o.frequency.setValueAtTime(1400,e+.3),n.gain.setValueAtTime(0,e),n.gain.linearRampToValueAtTime(this.volume*.25,e+.05),n.gain.exponentialRampToValueAtTime(.001,e+.4),o.start(e),o.stop(e+.5)}}createErrorSound(){return()=>{if(!this.isEnabled||!this.audioContext)return;const e=this.audioContext.currentTime,o=this.audioContext.createOscillator(),n=this.audioContext.createGain();o.connect(n),n.connect(this.audioContext.destination),o.frequency.setValueAtTime(600,e),o.frequency.setValueAtTime(500,e+.1),o.frequency.setValueAtTime(400,e+.2),n.gain.setValueAtTime(0,e),n.gain.linearRampToValueAtTime(this.volume*.2,e+.05),n.gain.exponentialRampToValueAtTime(.001,e+.3),o.start(e),o.stop(e+.4)}}createAmbientSound(){return()=>{if(!this.isEnabled||!this.audioContext)return;const e=this.audioContext.currentTime,o=this.audioContext.createOscillator(),n=this.audioContext.createGain();o.connect(n),n.connect(this.audioContext.destination),o.frequency.setValueAtTime(60,e),n.gain.setValueAtTime(0,e),n.gain.linearRampToValueAtTime(this.volume*.05,e+1),o.start(e),o.stop(e+5)}}play(e){this.sounds[e]?this.sounds[e]():console.warn(`Sound '${e}' not found`)}playTransmission(){this.play("transmission")}playNotification(){console.log("Playing notification sound, audio enabled:",this.isEnabled),this.play("notification")}playSuccess(){this.play("success")}playError(){this.play("error")}playAmbient(){this.play("ambient")}toggle(){return this.isEnabled=!this.isEnabled,localStorage.setItem("audioEnabled",this.isEnabled),this.isEnabled}setVolume(e){this.volume=Math.max(0,Math.min(1,e)),localStorage.setItem("audioVolume",this.volume)}getVolume(){return this.volume}isAudioEnabled(){return this.isEnabled}resume(){this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}testAudio(){var e;console.log("Testing audio system..."),console.log("Audio enabled:",this.isEnabled),console.log("Audio context state:",(e=this.audioContext)==null?void 0:e.state),console.log("Volume:",this.volume),this.audioContext&&this.audioContext.state==="suspended"?(console.log("Audio context suspended, attempting to resume..."),this.audioContext.resume().then(()=>{console.log("Audio context resumed, playing test sound..."),this.playNotification()})):(console.log("Playing test notification sound..."),this.playNotification())}}const Rt=new Ho,Fo=()=>Rt.playTransmission(),Wo=()=>Rt.playNotification(),q=Object.freeze(Object.defineProperty({__proto__:null,playNotification:Wo,playTransmission:Fo},Symbol.toStringTag,{value:"Module"}));
